import _extends from "@babel/runtime/helpers/esm/extends";
import _slicedToArray from "@babel/runtime/helpers/esm/slicedToArray";
import _objectWithoutProperties from "@babel/runtime/helpers/esm/objectWithoutProperties";
var _excluded = ["children", "containerProps", "preventBodyScrolling", "shouldCloseOnClick", "shouldCloseOnEscapePress", "onBeforeClose", "onExit", "onExiting", "onExited", "onEnter", "onEntering", "onEntered", "isShown"];
import React, { memo, useState, useEffect, useRef } from 'react';
import cx from 'classnames';
import { css } from 'glamor';
import PropTypes from 'prop-types';
import { Transition } from 'react-transition-group';
import Box from 'ui-box';
import { StackingOrder } from '../../constants';
import preventBodyScroll from '../../lib/prevent-body-scroll';
import safeInvoke from '../../lib/safe-invoke';
import { Portal } from '../../portal';
import { Stack } from '../../stack';
import { useTheme } from '../../theme';

var noop = function noop() {};

var emptyProps = {};
var animationEasing = {
  standard: 'cubic-bezier(0.4, 0.0, 0.2, 1)',
  deceleration: 'cubic-bezier(0.0, 0.0, 0.2, 1)',
  acceleration: 'cubic-bezier(0.4, 0.0, 1, 1)',
  sharp: 'cubic-bezier(0.4, 0.0, 0.6, 1)',
  spring: 'cubic-bezier(0.175, 0.885, 0.320, 1.175)'
};
var ANIMATION_DURATION = 240;
var fadeInAnimation = css.keyframes('fadeInAnimation', {
  from: {
    opacity: 0
  },
  to: {
    opacity: 1
  }
});
var fadeOutAnimation = css.keyframes('fadeOutAnimation', {
  from: {
    opacity: 1
  },
  to: {
    opacity: 0
  }
});

var animationStyles = function animationStyles(backgroundColor) {
  return {
    '&::before': {
      backgroundColor: backgroundColor,
      left: 0,
      top: 0,
      position: 'fixed',
      display: 'block',
      width: '100%',
      height: '100%',
      content: '" "'
    },
    '&[data-state="entering"]::before, &[data-state="entered"]::before': {
      animation: "".concat(fadeInAnimation, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.deceleration, " both")
    },
    '&[data-state="exiting"]::before, &[data-state="exited"]::before': {
      animation: "".concat(fadeOutAnimation, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.acceleration, " both")
    }
  };
};
/**
 * Overlay is essentially a wrapper around react-transition-group/Transition
 */


var Overlay = /*#__PURE__*/memo(function Overlay(_ref) {
  var children = _ref.children,
      _ref$containerProps = _ref.containerProps,
      containerProps = _ref$containerProps === void 0 ? emptyProps : _ref$containerProps,
      _ref$preventBodyScrol = _ref.preventBodyScrolling,
      preventBodyScrolling = _ref$preventBodyScrol === void 0 ? false : _ref$preventBodyScrol,
      _ref$shouldCloseOnCli = _ref.shouldCloseOnClick,
      shouldCloseOnClick = _ref$shouldCloseOnCli === void 0 ? true : _ref$shouldCloseOnCli,
      _ref$shouldCloseOnEsc = _ref.shouldCloseOnEscapePress,
      shouldCloseOnEscapePress = _ref$shouldCloseOnEsc === void 0 ? true : _ref$shouldCloseOnEsc,
      onBeforeClose = _ref.onBeforeClose,
      _ref$onExit = _ref.onExit,
      onExit = _ref$onExit === void 0 ? noop : _ref$onExit,
      _ref$onExiting = _ref.onExiting,
      onExiting = _ref$onExiting === void 0 ? noop : _ref$onExiting,
      _ref$onExited = _ref.onExited,
      onExited = _ref$onExited === void 0 ? noop : _ref$onExited,
      _ref$onEnter = _ref.onEnter,
      onEnter = _ref$onEnter === void 0 ? noop : _ref$onEnter,
      _ref$onEntering = _ref.onEntering,
      onEntering = _ref$onEntering === void 0 ? noop : _ref$onEntering,
      _ref$onEntered = _ref.onEntered,
      onEntered = _ref$onEntered === void 0 ? noop : _ref$onEntered,
      isShown = _ref.isShown,
      props = _objectWithoutProperties(_ref, _excluded);

  var theme = useTheme();
  var colors = theme.colors;

  var _useState = useState(null),
      _useState2 = _slicedToArray(_useState, 2),
      previousActiveElement = _useState2[0],
      setPreviousActiveElement = _useState2[1];

  var _useState3 = useState(isShown ? 'entering' : 'exited'),
      _useState4 = _slicedToArray(_useState3, 2),
      status = _useState4[0],
      setStatus = _useState4[1];

  var containerRef = useRef(null);
  useEffect(function () {
    if (isShown) {
      setStatus('entering');
    }
  }, [isShown]);

  var close = function close() {
    var shouldClose = safeInvoke(onBeforeClose);

    if (shouldClose !== false) {
      setStatus('exiting');
    }
  };

  var onEsc = function onEsc(event) {
    if (event.key === 'Escape' && shouldCloseOnEscapePress) {
      close();
    }
  };

  useEffect(function () {
    if (status === 'entered') {
      setPreviousActiveElement(document.activeElement);
      bringFocusInsideOverlay();
    }

    if (status === 'entering') {
      document.body.addEventListener('keydown', onEsc, false);
    }

    if (status === 'exiting') {
      document.body.removeEventListener('keydown', onEsc, false);
      bringFocusBackToTarget();
    } // These missing deps *should* be okay (adding them would require other changes)
    // eslint-disable-next-line react-hooks/exhaustive-deps

  }, [status]); // ComponentWillUnmount

  useEffect(function () {
    return function () {
      handleBodyScroll(false);
      document.body.removeEventListener('keydown', onEsc, false);
    };
  }, // These missing deps *should* be okay (adding them would require other changes)
  // eslint-disable-next-line react-hooks/exhaustive-deps
  []);
  /**
   * Methods borrowed from BlueprintJS
   * https://github.com/palantir/blueprint/blob/release/2.0.0/packages/core/src/components/overlay/overlay.tsx
   */

  var bringFocusInsideOverlay = function bringFocusInsideOverlay() {
    // Always delay focus manipulation to just before repaint to prevent scroll jumping
    return requestAnimationFrame(function () {
      // Container ref may be undefined between component mounting and Portal rendering
      // activeElement may be undefined in some rare cases in IE
      if (containerRef.current == null || // eslint-disable-line eqeqeq, no-eq-null
      document.activeElement == null || // eslint-disable-line eqeqeq, no-eq-null
      !isShown) {
        return;
      }

      var isFocusOutsideModal = !containerRef.current.contains(document.activeElement);

      if (isFocusOutsideModal) {
        // Element marked autofocus has higher priority than the other clowns
        var autofocusElement = containerRef.current.querySelector('[autofocus]');
        var wrapperElement = containerRef.current.querySelector('[tabindex]');
        var buttonElement = containerRef.current.querySelector('button');

        if (autofocusElement) {
          autofocusElement.focus();
        } else if (wrapperElement) {
          wrapperElement.focus();
        } else if (buttonElement) {
          buttonElement.focus();
        }
      }
    });
  };

  var bringFocusBackToTarget = function bringFocusBackToTarget() {
    return requestAnimationFrame(function () {
      if (previousActiveElement == null || // eslint-disable-line eqeqeq, no-eq-null
      containerRef.current == null || // eslint-disable-line eqeqeq, no-eq-null
      document.activeElement == null // eslint-disable-line eqeqeq, no-eq-null
      ) {
        return;
      } // Bring back focus on the target.


      var isFocusInsideModal = containerRef.current.contains(document.activeElement);

      if (document.activeElement === document.body || isFocusInsideModal) {
        previousActiveElement.focus();
      }
    });
  };

  var handleBodyScroll = function handleBodyScroll(preventScroll) {
    if (preventBodyScrolling) {
      preventBodyScroll(preventScroll);
    }
  };

  var handleEnter = function handleEnter(node, isAppearing) {
    handleBodyScroll(true);
    safeInvoke(onEnter, node, isAppearing);
  };

  var handleEntering = function handleEntering(node, isAppearing) {
    setStatus('entering');
    safeInvoke(onEntering, node, isAppearing);
  };

  var handleEntered = function handleEntered(node, isAppearing) {
    setStatus('entered');
    safeInvoke(onEntered, node, isAppearing);
  };

  var handleExit = function handleExit(node) {
    handleBodyScroll(false);
    safeInvoke(onExit, node);
  };

  var handleExiting = function handleExiting(node) {
    setStatus('exiting');
    safeInvoke(onExiting, node);
  };

  var handleExited = function handleExited(node) {
    setStatus('exited');
    safeInvoke(onExited, node);
  };

  var handleBackdropClick = function handleBackdropClick(event) {
    if (event.target !== event.currentTarget || !shouldCloseOnClick) {
      return;
    }

    close();
  };

  if (status === 'exited') {
    return null;
  }

  return /*#__PURE__*/React.createElement(Stack, {
    value: StackingOrder.OVERLAY
  }, function (zIndex) {
    return /*#__PURE__*/React.createElement(Portal, null, /*#__PURE__*/React.createElement(Transition, {
      nodeRef: containerRef,
      appear: true,
      unmountOnExit: true,
      timeout: ANIMATION_DURATION,
      "in": isShown && status !== 'exiting',
      onExit: handleExit,
      onExiting: handleExiting,
      onExited: handleExited,
      onEnter: handleEnter,
      onEntering: handleEntering,
      onEntered: handleEntered
    }, function (state) {
      return /*#__PURE__*/React.createElement(Box, _extends({
        onClick: handleBackdropClick,
        ref: containerRef,
        position: "fixed",
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        zIndex: zIndex,
        "data-state": state
      }, containerProps, {
        className: cx(containerProps.className, css(animationStyles(colors.overlay)).toString())
      }), typeof children === 'function' ? children({
        state: state,
        close: close
      }) : children);
    }));
  });
});
Overlay.propTypes = {
  /**
   * Children can be a node or a function accepting `close: func`
   * and `state: ENTERING | ENTERED | EXITING | EXITED`.
   */
  children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]).isRequired,

  /**
   * Show the component; triggers the enter or exit states.
   */
  isShown: PropTypes.bool,

  /**
   * Props to be passed through on the inner Box.
   */
  containerProps: PropTypes.object,

  /**
   * Whether or not to prevent body scrolling outside the context of the overlay
   */
  preventBodyScrolling: PropTypes.bool,

  /**
   * Boolean indicating if clicking the overlay should close the overlay.
   */
  shouldCloseOnClick: PropTypes.bool,

  /**
   * Boolean indicating if pressing the esc key should close the overlay.
   */
  shouldCloseOnEscapePress: PropTypes.bool,

  /**
   * Function called when overlay is about to close.
   * Return `false` to prevent the sheet from closing.
   * type: `Function -> Boolean`
   */
  onBeforeClose: PropTypes.func,

  /**
   * Callback fired before the "exiting" status is applied.
   * type: `Function(node: HtmlElement) -> void`
   */
  onExit: PropTypes.func,

  /**
   * Callback fired after the "exiting" status is applied.
   * type: `Function(node: HtmlElement) -> void`
   */
  onExiting: PropTypes.func,

  /**
   * Callback fired after the "exited" status is applied.
   * type: `Function(exitState: Any?, node: HtmlElement) -> void`
   */
  onExited: PropTypes.func,

  /**
   * Callback fired before the "entering" status is applied.
   * An extra parameter isAppearing is supplied to indicate if the enter stage
   * is occurring on the initial mount.
   *
   * type: `Function(node: HtmlElement, isAppearing: bool) -> void`
   */
  onEnter: PropTypes.func,

  /**
   * Callback fired after the "entering" status is applied.
   * An extra parameter isAppearing is supplied to indicate if the enter stage
   * is occurring on the initial mount.
   *
   * type: `Function(node: HtmlElement, isAppearing: bool) -> void`
   */
  onEntering: PropTypes.func,

  /**
   * Callback fired after the "entered" status is applied.
   * An extra parameter isAppearing is supplied to indicate if the enter stage
   * is occurring on the initial mount.
   *
   * type: `Function(node: HtmlElement, isAppearing: bool) -> void`
   */
  onEntered: PropTypes.func
};
export default Overlay;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9vdmVybGF5L3NyYy9PdmVybGF5LmpzIl0sIm5hbWVzIjpbIlJlYWN0IiwibWVtbyIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlUmVmIiwiY3giLCJjc3MiLCJQcm9wVHlwZXMiLCJUcmFuc2l0aW9uIiwiQm94IiwiU3RhY2tpbmdPcmRlciIsInByZXZlbnRCb2R5U2Nyb2xsIiwic2FmZUludm9rZSIsIlBvcnRhbCIsIlN0YWNrIiwidXNlVGhlbWUiLCJub29wIiwiZW1wdHlQcm9wcyIsImFuaW1hdGlvbkVhc2luZyIsInN0YW5kYXJkIiwiZGVjZWxlcmF0aW9uIiwiYWNjZWxlcmF0aW9uIiwic2hhcnAiLCJzcHJpbmciLCJBTklNQVRJT05fRFVSQVRJT04iLCJmYWRlSW5BbmltYXRpb24iLCJrZXlmcmFtZXMiLCJmcm9tIiwib3BhY2l0eSIsInRvIiwiZmFkZU91dEFuaW1hdGlvbiIsImFuaW1hdGlvblN0eWxlcyIsImJhY2tncm91bmRDb2xvciIsImxlZnQiLCJ0b3AiLCJwb3NpdGlvbiIsImRpc3BsYXkiLCJ3aWR0aCIsImhlaWdodCIsImNvbnRlbnQiLCJhbmltYXRpb24iLCJPdmVybGF5IiwiY2hpbGRyZW4iLCJjb250YWluZXJQcm9wcyIsInByZXZlbnRCb2R5U2Nyb2xsaW5nIiwic2hvdWxkQ2xvc2VPbkNsaWNrIiwic2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzIiwib25CZWZvcmVDbG9zZSIsIm9uRXhpdCIsIm9uRXhpdGluZyIsIm9uRXhpdGVkIiwib25FbnRlciIsIm9uRW50ZXJpbmciLCJvbkVudGVyZWQiLCJpc1Nob3duIiwicHJvcHMiLCJ0aGVtZSIsImNvbG9ycyIsInByZXZpb3VzQWN0aXZlRWxlbWVudCIsInNldFByZXZpb3VzQWN0aXZlRWxlbWVudCIsInN0YXR1cyIsInNldFN0YXR1cyIsImNvbnRhaW5lclJlZiIsImNsb3NlIiwic2hvdWxkQ2xvc2UiLCJvbkVzYyIsImV2ZW50Iiwia2V5IiwiZG9jdW1lbnQiLCJhY3RpdmVFbGVtZW50IiwiYnJpbmdGb2N1c0luc2lkZU92ZXJsYXkiLCJib2R5IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJicmluZ0ZvY3VzQmFja1RvVGFyZ2V0IiwiaGFuZGxlQm9keVNjcm9sbCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImN1cnJlbnQiLCJpc0ZvY3VzT3V0c2lkZU1vZGFsIiwiY29udGFpbnMiLCJhdXRvZm9jdXNFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsIndyYXBwZXJFbGVtZW50IiwiYnV0dG9uRWxlbWVudCIsImZvY3VzIiwiaXNGb2N1c0luc2lkZU1vZGFsIiwicHJldmVudFNjcm9sbCIsImhhbmRsZUVudGVyIiwibm9kZSIsImlzQXBwZWFyaW5nIiwiaGFuZGxlRW50ZXJpbmciLCJoYW5kbGVFbnRlcmVkIiwiaGFuZGxlRXhpdCIsImhhbmRsZUV4aXRpbmciLCJoYW5kbGVFeGl0ZWQiLCJoYW5kbGVCYWNrZHJvcENsaWNrIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIk9WRVJMQVkiLCJ6SW5kZXgiLCJzdGF0ZSIsImNsYXNzTmFtZSIsIm92ZXJsYXkiLCJ0b1N0cmluZyIsInByb3BUeXBlcyIsIm9uZU9mVHlwZSIsImZ1bmMiLCJpc1JlcXVpcmVkIiwiYm9vbCIsIm9iamVjdCJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU9BLEtBQVAsSUFBZ0JDLElBQWhCLEVBQXNCQyxRQUF0QixFQUFnQ0MsU0FBaEMsRUFBMkNDLE1BQTNDLFFBQXlELE9BQXpEO0FBQ0EsT0FBT0MsRUFBUCxNQUFlLFlBQWY7QUFDQSxTQUFTQyxHQUFULFFBQW9CLFFBQXBCO0FBQ0EsT0FBT0MsU0FBUCxNQUFzQixZQUF0QjtBQUNBLFNBQVNDLFVBQVQsUUFBMkIsd0JBQTNCO0FBQ0EsT0FBT0MsR0FBUCxNQUFnQixRQUFoQjtBQUNBLFNBQVNDLGFBQVQsUUFBOEIsaUJBQTlCO0FBQ0EsT0FBT0MsaUJBQVAsTUFBOEIsK0JBQTlCO0FBQ0EsT0FB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QVMsQ0FBQ3FHLElBekJaOztBQTJCbEI7QUFDRjtBQUNBO0FBQ0U5RCxFQUFBQSx3QkFBd0IsRUFBRXZDLFNBQVMsQ0FBQ3FHLElBOUJsQjs7QUFnQ2xCO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDRTdELEVBQUFBLGFBQWEsRUFBRXhDLFNBQVMsQ0FBQ21HLElBckNQOztBQXVDbEI7QUFDRjtBQUNBO0FBQ0E7QUFDRTFELEVBQUFBLE1BQU0sRUFBRXpDLFNBQVMsQ0FBQ21HLElBM0NBOztBQTZDbEI7QUFDRjtBQUNBO0FBQ0E7QUFDRXpELEVBQUFBLFNBQVMsRUFBRTFDLFNBQVMsQ0FBQ21HLElBakRIOztBQW1EbEI7QUFDRjtBQUNBO0FBQ0E7QUFDRXhELEVBQUFBLFFBQVEsRUFBRTNDLFNBQVMsQ0FBQ21HLElBdkRGOztBQXlEbEI7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRXZELEVBQUFBLE9BQU8sRUFBRTVDLFNBQVMsQ0FBQ21HLElBaEVEOztBQWtFbEI7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRXRELEVBQUFBLFVBQVUsRUFBRTdDLFNBQVMsQ0FBQ21HLElBekVKOztBQTJFbEI7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRXJELEVBQUFBLFNBQVMsRUFBRTlDLFNBQVMsQ0FBQ21HO0FBbEZILENBQXBCO0FBcUZBLGVBQWVqRSxPQUFmIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IG1lbW8sIHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IGN4IGZyb20gJ2NsYXNzbmFtZXMnXG5pbXBvcnQgeyBjc3MgfSBmcm9tICdnbGFtb3InXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnXG5pbXBvcnQgeyBUcmFuc2l0aW9uIH0gZnJvbSAncmVhY3QtdHJhbnNpdGlvbi1ncm91cCdcbmltcG9ydCBCb3ggZnJvbSAndWktYm94J1xuaW1wb3J0IHsgU3RhY2tpbmdPcmRlciB9IGZyb20gJy4uLy4uL2NvbnN0YW50cydcbmltcG9ydCBwcmV2ZW50Qm9keVNjcm9sbCBmcm9tICcuLi8uLi9saWIvcHJldmVudC1ib2R5LXNjcm9sbCdcbmltcG9ydCBzYWZlSW52b2tlIGZyb20gJy4uLy4uL2xpYi9zYWZlLWludm9rZSdcbmltcG9ydCB7IFBvcnRhbCB9IGZyb20gJy4uLy4uL3BvcnRhbCdcbmltcG9ydCB7IFN0YWNrIH0gZnJvbSAnLi4vLi4vc3RhY2snXG5pbXBvcnQgeyB1c2VUaGVtZSB9IGZyb20gJy4uLy4uL3RoZW1lJ1xuXG5jb25zdCBub29wID0gKCkgPT4ge31cbmNvbnN0IGVtcHR5UHJvcHMgPSB7fVxuXG5jb25zdCBhbmltYXRpb25FYXNpbmcgPSB7XG4gIHN0YW5kYXJkOiAnY3ViaWMtYmV6aWVyKDAuNCwgMC4wLCAwLjIsIDEpJyxcbiAgZGVjZWxlcmF0aW9uOiAnY3ViaWMtYmV6aWVyKDAuMCwgMC4wLCAwLjIsIDEpJyxcbiAgYWNjZWxlcmF0aW9uOiAnY3ViaWMtYmV6aWVyKDAuNCwgMC4wLCAxLCAxKScsXG4gIHNoYXJwOiAnY3ViaWMtYmV6aWVyKDAuNCwgMC4wLCAwLjYsIDEpJyxcbiAgc3ByaW5nOiAnY3ViaWMtYmV6aWVyKDAuMTc1LCAwLjg4NSwgMC4zMjAsIDEuMTc1KSdcbn1cblxuY29uc3QgQU5JTUFUSU9OX0RVUkFUSU9OID0gMjQwXG5cbmNvbnN0IGZhZGVJbkFuaW1hdGlvbiA9IGNzcy5rZXlmcmFtZXMoJ2ZhZGVJbkFuaW1hdGlvbicsIHtcbiAgZnJvbToge1xuICAgIG9wYWNpdHk6IDBcbiAgfSxcbiAgdG86IHtcbiAgICBvcGFjaXR5OiAxXG4gIH1cbn0pXG5cbmNvbnN0IGZhZGVPdXRBbmltYXRpb24gPSBjc3Mua2V5ZnJhbWVzKCdmYWRlT3V0QW5pbWF0aW9uJywge1xuICBmcm9tOiB7XG4gICAgb3BhY2l0eTogMVxuICB9LFxuICB0bzoge1xuICAgIG9wYWNpdHk6IDBcbiAgfVxufSlcblxuY29uc3QgYW5pbWF0aW9uU3R5bGVzID0gYmFja2dyb3VuZENvbG9yID0+ICh7XG4gICcmOjpiZWZvcmUnOiB7XG4gICAgYmFja2dyb3VuZENvbG9yLFxuICAgIGxlZnQ6IDAsXG4gICAgdG9wOiAwLFxuICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxuICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgd2lkdGg6ICcxMDAlJyxcbiAgICBoZWlnaHQ6ICcxMDAlJyxcbiAgICBjb250ZW50OiAnXCIgXCInXG4gIH0sXG4gICcmW2RhdGEtc3RhdGU9XCJlbnRlcmluZ1wiXTo6YmVmb3JlLCAmW2RhdGEtc3RhdGU9XCJlbnRlcmVkXCJdOjpiZWZvcmUnOiB7XG4gICAgYW5pbWF0aW9uOiBgJHtmYWRlSW5BbmltYXRpb259ICR7QU5JTUFUSU9OX0RVUkFUSU9OfW1zICR7YW5pbWF0aW9uRWFzaW5nLmRlY2VsZXJhdGlvbn0gYm90aGBcbiAgfSxcbiAgJyZbZGF0YS1zdGF0ZT1cImV4aXRpbmdcIl06OmJlZm9yZSwgJltkYXRhLXN0YXRlPVwiZXhpdGVkXCJdOjpiZWZvcmUnOiB7XG4gICAgYW5pbWF0aW9uOiBgJHtmYWRlT3V0QW5pbWF0aW9ufSAke0FOSU1BVElPTl9EVVJBVElPTn1tcyAke2FuaW1hdGlvbkVhc2luZy5hY2NlbGVyYXRpb259IGJvdGhgXG4gIH1cbn0pXG5cbi8qKlxuICogT3ZlcmxheSBpcyBlc3NlbnRpYWxseSBhIHdyYXBwZXIgYXJvdW5kIHJlYWN0LXRyYW5zaXRpb24tZ3JvdXAvVHJhbnNpdGlvblxuICovXG5jb25zdCBPdmVybGF5ID0gbWVtbyhmdW5jdGlvbiBPdmVybGF5KHtcbiAgY2hpbGRyZW4sXG4gIGNvbnRhaW5lclByb3BzID0gZW1wdHlQcm9wcyxcbiAgcHJldmVudEJvZHlTY3JvbGxpbmcgPSBmYWxzZSxcbiAgc2hvdWxkQ2xvc2VPbkNsaWNrID0gdHJ1ZSxcbiAgc2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzID0gdHJ1ZSxcbiAgb25CZWZvcmVDbG9zZSxcbiAgb25FeGl0ID0gbm9vcCxcbiAgb25FeGl0aW5nID0gbm9vcCxcbiAgb25FeGl0ZWQgPSBub29wLFxuICBvbkVudGVyID0gbm9vcCxcbiAgb25FbnRlcmluZyA9IG5vb3AsXG4gIG9uRW50ZXJlZCA9IG5vb3AsXG4gIGlzU2hvd24sXG4gIC4uLnByb3BzXG59KSB7XG4gIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKVxuICBjb25zdCB7IGNvbG9ycyB9ID0gdGhlbWVcbiAgY29uc3QgW3ByZXZpb3VzQWN0aXZlRWxlbWVudCwgc2V0UHJldmlvdXNBY3RpdmVFbGVtZW50XSA9IHVzZVN0YXRlKG51bGwpXG4gIGNvbnN0IFtzdGF0dXMsIHNldFN0YXR1c10gPSB1c2VTdGF0ZShpc1Nob3duID8gJ2VudGVyaW5nJyA6ICdleGl0ZWQnKVxuICBjb25zdCBjb250YWluZXJSZWYgPSB1c2VSZWYobnVsbClcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc1Nob3duKSB7XG4gICAgICBzZXRTdGF0dXMoJ2VudGVyaW5nJylcbiAgICB9XG4gIH0sIFtpc1Nob3duXSlcblxuICBjb25zdCBjbG9zZSA9ICgpID0+IHtcbiAgICBjb25zdCBzaG91bGRDbG9zZSA9IHNhZmVJbnZva2Uob25CZWZvcmVDbG9zZSlcbiAgICBpZiAoc2hvdWxkQ2xvc2UgIT09IGZhbHNlKSB7XG4gICAgICBzZXRTdGF0dXMoJ2V4aXRpbmcnKVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9uRXNjID0gZXZlbnQgPT4ge1xuICAgIGlmIChldmVudC5rZXkgPT09ICdFc2NhcGUnICYmIHNob3VsZENsb3NlT25Fc2NhcGVQcmVzcykge1xuICAgICAgY2xvc2UoKVxuICAgIH1cbiAgfVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHN0YXR1cyA9PT0gJ2VudGVyZWQnKSB7XG4gICAgICBzZXRQcmV2aW91c0FjdGl2ZUVsZW1lbnQoZG9jdW1lbnQuYWN0aXZlRWxlbWVudClcbiAgICAgIGJyaW5nRm9jdXNJbnNpZGVPdmVybGF5KClcbiAgICB9XG5cbiAgICBpZiAoc3RhdHVzID09PSAnZW50ZXJpbmcnKSB7XG4gICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBvbkVzYywgZmFsc2UpXG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gJ2V4aXRpbmcnKSB7XG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBvbkVzYywgZmFsc2UpXG4gICAgICBicmluZ0ZvY3VzQmFja1RvVGFyZ2V0KClcbiAgICB9XG4gICAgLy8gVGhlc2UgbWlzc2luZyBkZXBzICpzaG91bGQqIGJlIG9rYXkgKGFkZGluZyB0aGVtIHdvdWxkIHJlcXVpcmUgb3RoZXIgY2hhbmdlcylcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtzdGF0dXNdKVxuXG4gIC8vIENvbXBvbmVudFdpbGxVbm1vdW50XG4gIHVzZUVmZmVjdChcbiAgICAoKSA9PiAoKSA9PiB7XG4gICAgICBoYW5kbGVCb2R5U2Nyb2xsKGZhbHNlKVxuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25Fc2MsIGZhbHNlKVxuICAgIH0sXG4gICAgLy8gVGhlc2UgbWlzc2luZyBkZXBzICpzaG91bGQqIGJlIG9rYXkgKGFkZGluZyB0aGVtIHdvdWxkIHJlcXVpcmUgb3RoZXIgY2hhbmdlcylcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gICAgW11cbiAgKVxuXG4gIC8qKlxuICAgKiBNZXRob2RzIGJvcnJvd2VkIGZyb20gQmx1ZXByaW50SlNcbiAgICogaHR0cHM6Ly9naXRodWIuY29tL3BhbGFudGlyL2JsdWVwcmludC9ibG9iL3JlbGVhc2UvMi4wLjAvcGFja2FnZXMvY29yZS9zcmMvY29tcG9uZW50cy9vdmVybGF5L292ZXJsYXkudHN4XG4gICAqL1xuICBjb25zdCBicmluZ0ZvY3VzSW5zaWRlT3ZlcmxheSA9ICgpID0+IHtcbiAgICAvLyBBbHdheXMgZGVsYXkgZm9jdXMgbWFuaXB1bGF0aW9uIHRvIGp1c3QgYmVmb3JlIHJlcGFpbnQgdG8gcHJldmVudCBzY3JvbGwganVtcGluZ1xuICAgIHJldHVybiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgLy8gQ29udGFpbmVyIHJlZiBtYXkgYmUgdW5kZWZpbmVkIGJldHdlZW4gY29tcG9uZW50IG1vdW50aW5nIGFuZCBQb3J0YWwgcmVuZGVyaW5nXG4gICAgICAvLyBhY3RpdmVFbGVtZW50IG1heSBiZSB1bmRlZmluZWQgaW4gc29tZSByYXJlIGNhc2VzIGluIElFXG5cbiAgICAgIGlmIChcbiAgICAgICAgY29udGFpbmVyUmVmLmN1cnJlbnQgPT0gbnVsbCB8fCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGVxZXFlcSwgbm8tZXEtbnVsbFxuICAgICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09IG51bGwgfHwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBlcWVxZXEsIG5vLWVxLW51bGxcbiAgICAgICAgIWlzU2hvd25cbiAgICAgICkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgY29uc3QgaXNGb2N1c091dHNpZGVNb2RhbCA9ICFjb250YWluZXJSZWYuY3VycmVudC5jb250YWlucyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KVxuICAgICAgaWYgKGlzRm9jdXNPdXRzaWRlTW9kYWwpIHtcbiAgICAgICAgLy8gRWxlbWVudCBtYXJrZWQgYXV0b2ZvY3VzIGhhcyBoaWdoZXIgcHJpb3JpdHkgdGhhbiB0aGUgb3RoZXIgY2xvd25zXG4gICAgICAgIGNvbnN0IGF1dG9mb2N1c0VsZW1lbnQgPSBjb250YWluZXJSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yKCdbYXV0b2ZvY3VzXScpXG4gICAgICAgIGNvbnN0IHdyYXBwZXJFbGVtZW50ID0gY29udGFpbmVyUmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcignW3RhYmluZGV4XScpXG4gICAgICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBjb250YWluZXJSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yKCdidXR0b24nKVxuXG4gICAgICAgIGlmIChhdXRvZm9jdXNFbGVtZW50KSB7XG4gICAgICAgICAgYXV0b2ZvY3VzRWxlbWVudC5mb2N1cygpXG4gICAgICAgIH0gZWxzZSBpZiAod3JhcHBlckVsZW1lbnQpIHtcbiAgICAgICAgICB3cmFwcGVyRWxlbWVudC5mb2N1cygpXG4gICAgICAgIH0gZWxzZSBpZiAoYnV0dG9uRWxlbWVudCkge1xuICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuZm9jdXMoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGNvbnN0IGJyaW5nRm9jdXNCYWNrVG9UYXJnZXQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIHByZXZpb3VzQWN0aXZlRWxlbWVudCA9PSBudWxsIHx8IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxLCBuby1lcS1udWxsXG4gICAgICAgIGNvbnRhaW5lclJlZi5jdXJyZW50ID09IG51bGwgfHwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBlcWVxZXEsIG5vLWVxLW51bGxcbiAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PSBudWxsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxLCBuby1lcS1udWxsXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIC8vIEJyaW5nIGJhY2sgZm9jdXMgb24gdGhlIHRhcmdldC5cbiAgICAgIGNvbnN0IGlzRm9jdXNJbnNpZGVNb2RhbCA9IGNvbnRhaW5lclJlZi5jdXJyZW50LmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpXG4gICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gZG9jdW1lbnQuYm9keSB8fCBpc0ZvY3VzSW5zaWRlTW9kYWwpIHtcbiAgICAgICAgcHJldmlvdXNBY3RpdmVFbGVtZW50LmZvY3VzKClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgY29uc3QgaGFuZGxlQm9keVNjcm9sbCA9IHByZXZlbnRTY3JvbGwgPT4ge1xuICAgIGlmIChwcmV2ZW50Qm9keVNjcm9sbGluZykge1xuICAgICAgcHJldmVudEJvZHlTY3JvbGwocHJldmVudFNjcm9sbClcbiAgICB9XG4gIH1cblxuICBjb25zdCBoYW5kbGVFbnRlciA9IChub2RlLCBpc0FwcGVhcmluZykgPT4ge1xuICAgIGhhbmRsZUJvZHlTY3JvbGwodHJ1ZSlcbiAgICBzYWZlSW52b2tlKG9uRW50ZXIsIG5vZGUsIGlzQXBwZWFyaW5nKVxuICB9XG5cbiAgY29uc3QgaGFuZGxlRW50ZXJpbmcgPSAobm9kZSwgaXNBcHBlYXJpbmcpID0+IHtcbiAgICBzZXRTdGF0dXMoJ2VudGVyaW5nJylcbiAgICBzYWZlSW52b2tlKG9uRW50ZXJpbmcsIG5vZGUsIGlzQXBwZWFyaW5nKVxuICB9XG5cbiAgY29uc3QgaGFuZGxlRW50ZXJlZCA9IChub2RlLCBpc0FwcGVhcmluZykgPT4ge1xuICAgIHNldFN0YXR1cygnZW50ZXJlZCcpXG4gICAgc2FmZUludm9rZShvbkVudGVyZWQsIG5vZGUsIGlzQXBwZWFyaW5nKVxuICB9XG5cbiAgY29uc3QgaGFuZGxlRXhpdCA9IG5vZGUgPT4ge1xuICAgIGhhbmRsZUJvZHlTY3JvbGwoZmFsc2UpXG4gICAgc2FmZUludm9rZShvbkV4aXQsIG5vZGUpXG4gIH1cblxuICBjb25zdCBoYW5kbGVFeGl0aW5nID0gbm9kZSA9PiB7XG4gICAgc2V0U3RhdHVzKCdleGl0aW5nJylcbiAgICBzYWZlSW52b2tlKG9uRXhpdGluZywgbm9kZSlcbiAgfVxuXG4gIGNvbnN0IGhhbmRsZUV4aXRlZCA9IG5vZGUgPT4ge1xuICAgIHNldFN0YXR1cygnZXhpdGVkJylcbiAgICBzYWZlSW52b2tlKG9uRXhpdGVkLCBub2RlKVxuICB9XG5cbiAgY29uc3QgaGFuZGxlQmFja2Ryb3BDbGljayA9IGV2ZW50ID0+IHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0ICE9PSBldmVudC5jdXJyZW50VGFyZ2V0IHx8ICFzaG91bGRDbG9zZU9uQ2xpY2spIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNsb3NlKClcbiAgfVxuXG4gIGlmIChzdGF0dXMgPT09ICdleGl0ZWQnKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPFN0YWNrIHZhbHVlPXtTdGFja2luZ09yZGVyLk9WRVJMQVl9PlxuICAgICAge3pJbmRleCA9PiAoXG4gICAgICAgIDxQb3J0YWw+XG4gICAgICAgICAgPFRyYW5zaXRpb25cbiAgICAgICAgICAgIG5vZGVSZWY9e2NvbnRhaW5lclJlZn1cbiAgICAgICAgICAgIGFwcGVhclxuICAgICAgICAgICAgdW5tb3VudE9uRXhpdFxuICAgICAgICAgICAgdGltZW91dD17QU5JTUFUSU9OX0RVUkFUSU9OfVxuICAgICAgICAgICAgaW49e2lzU2hvd24gJiYgc3RhdHVzICE9PSAnZXhpdGluZyd9XG4gICAgICAgICAgICBvbkV4aXQ9e2hhbmRsZUV4aXR9XG4gICAgICAgICAgICBvbkV4aXRpbmc9e2hhbmRsZUV4aXRpbmd9XG4gICAgICAgICAgICBvbkV4aXRlZD17aGFuZGxlRXhpdGVkfVxuICAgICAgICAgICAgb25FbnRlcj17aGFuZGxlRW50ZXJ9XG4gICAgICAgICAgICBvbkVudGVyaW5nPXtoYW5kbGVFbnRlcmluZ31cbiAgICAgICAgICAgIG9uRW50ZXJlZD17aGFuZGxlRW50ZXJlZH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7c3RhdGUgPT4gKFxuICAgICAgICAgICAgICA8Qm94XG4gICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQmFja2Ryb3BDbGlja31cbiAgICAgICAgICAgICAgICByZWY9e2NvbnRhaW5lclJlZn1cbiAgICAgICAgICAgICAgICBwb3NpdGlvbj1cImZpeGVkXCJcbiAgICAgICAgICAgICAgICB0b3A9ezB9XG4gICAgICAgICAgICAgICAgbGVmdD17MH1cbiAgICAgICAgICAgICAgICByaWdodD17MH1cbiAgICAgICAgICAgICAgICBib3R0b209ezB9XG4gICAgICAgICAgICAgICAgekluZGV4PXt6SW5kZXh9XG4gICAgICAgICAgICAgICAgZGF0YS1zdGF0ZT17c3RhdGV9XG4gICAgICAgICAgICAgICAgey4uLmNvbnRhaW5lclByb3BzfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y3goY29udGFpbmVyUHJvcHMuY2xhc3NOYW1lLCBjc3MoYW5pbWF0aW9uU3R5bGVzKGNvbG9ycy5vdmVybGF5KSkudG9TdHJpbmcoKSl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7dHlwZW9mIGNoaWxkcmVuID09PSAnZnVuY3Rpb24nID8gY2hpbGRyZW4oeyBzdGF0ZSwgY2xvc2UgfSkgOiBjaGlsZHJlbn1cbiAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvVHJhbnNpdGlvbj5cbiAgICAgICAgPC9Qb3J0YWw+XG4gICAgICApfVxuICAgIDwvU3RhY2s+XG4gIClcbn0pXG5cbk92ZXJsYXkucHJvcFR5cGVzID0ge1xuICAvKipcbiAgICogQ2hpbGRyZW4gY2FuIGJlIGEgbm9kZSBvciBhIGZ1bmN0aW9uIGFjY2VwdGluZyBgY2xvc2U6IGZ1bmNgXG4gICAqIGFuZCBgc3RhdGU6IEVOVEVSSU5HIHwgRU5URVJFRCB8IEVYSVRJTkcgfCBFWElURURgLlxuICAgKi9cbiAgY2hpbGRyZW46IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5ub2RlLCBQcm9wVHlwZXMuZnVuY10pLmlzUmVxdWlyZWQsXG5cbiAgLyoqXG4gICAqIFNob3cgdGhlIGNvbXBvbmVudDsgdHJpZ2dlcnMgdGhlIGVudGVyIG9yIGV4aXQgc3RhdGVzLlxuICAgKi9cbiAgaXNTaG93bjogUHJvcFR5cGVzLmJvb2wsXG5cbiAgLyoqXG4gICAqIFByb3BzIHRvIGJlIHBhc3NlZCB0aHJvdWdoIG9uIHRoZSBpbm5lciBCb3guXG4gICAqL1xuICBjb250YWluZXJQcm9wczogUHJvcFR5cGVzLm9iamVjdCxcblxuICAvKipcbiAgICogV2hldGhlciBvciBub3QgdG8gcHJldmVudCBib2R5IHNjcm9sbGluZyBvdXRzaWRlIHRoZSBjb250ZXh0IG9mIHRoZSBvdmVybGF5XG4gICAqL1xuICBwcmV2ZW50Qm9keVNjcm9sbGluZzogUHJvcFR5cGVzLmJvb2wsXG5cbiAgLyoqXG4gICAqIEJvb2xlYW4gaW5kaWNhdGluZyBpZiBjbGlja2luZyB0aGUgb3ZlcmxheSBzaG91bGQgY2xvc2UgdGhlIG92ZXJsYXkuXG4gICAqL1xuICBzaG91bGRDbG9zZU9uQ2xpY2s6IFByb3BUeXBlcy5ib29sLFxuXG4gIC8qKlxuICAgKiBCb29sZWFuIGluZGljYXRpbmcgaWYgcHJlc3NpbmcgdGhlIGVzYyBrZXkgc2hvdWxkIGNsb3NlIHRoZSBvdmVybGF5LlxuICAgKi9cbiAgc2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzOiBQcm9wVHlwZXMuYm9vbCxcblxuICAvKipcbiAgICogRnVuY3Rpb24gY2FsbGVkIHdoZW4gb3ZlcmxheSBpcyBhYm91dCB0byBjbG9zZS5cbiAgICogUmV0dXJuIGBmYWxzZWAgdG8gcHJldmVudCB0aGUgc2hlZXQgZnJvbSBjbG9zaW5nLlxuICAgKiB0eXBlOiBgRnVuY3Rpb24gLT4gQm9vbGVhbmBcbiAgICovXG4gIG9uQmVmb3JlQ2xvc2U6IFByb3BUeXBlcy5mdW5jLFxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmaXJlZCBiZWZvcmUgdGhlIFwiZXhpdGluZ1wiIHN0YXR1cyBpcyBhcHBsaWVkLlxuICAgKiB0eXBlOiBgRnVuY3Rpb24obm9kZTogSHRtbEVsZW1lbnQpIC0+IHZvaWRgXG4gICAqL1xuICBvbkV4aXQ6IFByb3BUeXBlcy5mdW5jLFxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmaXJlZCBhZnRlciB0aGUgXCJleGl0aW5nXCIgc3RhdHVzIGlzIGFwcGxpZWQuXG4gICAqIHR5cGU6IGBGdW5jdGlvbihub2RlOiBIdG1sRWxlbWVudCkgLT4gdm9pZGBcbiAgICovXG4gIG9uRXhpdGluZzogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZpcmVkIGFmdGVyIHRoZSBcImV4aXRlZFwiIHN0YXR1cyBpcyBhcHBsaWVkLlxuICAgKiB0eXBlOiBgRnVuY3Rpb24oZXhpdFN0YXRlOiBBbnk/LCBub2RlOiBIdG1sRWxlbWVudCkgLT4gdm9pZGBcbiAgICovXG4gIG9uRXhpdGVkOiBQcm9wVHlwZXMuZnVuYyxcblxuICAvKipcbiAgICogQ2FsbGJhY2sgZmlyZWQgYmVmb3JlIHRoZSBcImVudGVyaW5nXCIgc3RhdHVzIGlzIGFwcGxpZWQuXG4gICAqIEFuIGV4dHJhIHBhcmFtZXRlciBpc0FwcGVhcmluZyBpcyBzdXBwbGllZCB0byBpbmRpY2F0ZSBpZiB0aGUgZW50ZXIgc3RhZ2VcbiAgICogaXMgb2NjdXJyaW5nIG9uIHRoZSBpbml0aWFsIG1vdW50LlxuICAgKlxuICAgKiB0eXBlOiBgRnVuY3Rpb24obm9kZTogSHRtbEVsZW1lbnQsIGlzQXBwZWFyaW5nOiBib29sKSAtPiB2b2lkYFxuICAgKi9cbiAgb25FbnRlcjogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZpcmVkIGFmdGVyIHRoZSBcImVudGVyaW5nXCIgc3RhdHVzIGlzIGFwcGxpZWQuXG4gICAqIEFuIGV4dHJhIHBhcmFtZXRlciBpc0FwcGVhcmluZyBpcyBzdXBwbGllZCB0byBpbmRpY2F0ZSBpZiB0aGUgZW50ZXIgc3RhZ2VcbiAgICogaXMgb2NjdXJyaW5nIG9uIHRoZSBpbml0aWFsIG1vdW50LlxuICAgKlxuICAgKiB0eXBlOiBgRnVuY3Rpb24obm9kZTogSHRtbEVsZW1lbnQsIGlzQXBwZWFyaW5nOiBib29sKSAtPiB2b2lkYFxuICAgKi9cbiAgb25FbnRlcmluZzogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZpcmVkIGFmdGVyIHRoZSBcImVudGVyZWRcIiBzdGF0dXMgaXMgYXBwbGllZC5cbiAgICogQW4gZXh0cmEgcGFyYW1ldGVyIGlzQXBwZWFyaW5nIGlzIHN1cHBsaWVkIHRvIGluZGljYXRlIGlmIHRoZSBlbnRlciBzdGFnZVxuICAgKiBpcyBvY2N1cnJpbmcgb24gdGhlIGluaXRpYWwgbW91bnQuXG4gICAqXG4gICAqIHR5cGU6IGBGdW5jdGlvbihub2RlOiBIdG1sRWxlbWVudCwgaXNBcHBlYXJpbmc6IGJvb2wpIC0+IHZvaWRgXG4gICAqL1xuICBvbkVudGVyZWQ6IFByb3BUeXBlcy5mdW5jXG59XG5cbmV4cG9ydCBkZWZhdWx0IE92ZXJsYXlcbiJdfQ==