import _extends from "@babel/runtime/helpers/esm/extends";
import _toConsumableArray from "@babel/runtime/helpers/esm/toConsumableArray";
import _slicedToArray from "@babel/runtime/helpers/esm/slicedToArray";
import _objectWithoutProperties from "@babel/runtime/helpers/esm/objectWithoutProperties";
var _excluded = ["accept", "capture", "className", "disabled", "height", "multiple", "name", "onBlur", "onChange", "placeholder", "required"];
import React, { memo, forwardRef, useState, useRef, useCallback } from 'react';
import cx from 'classnames';
import PropTypes from 'prop-types';
import Box from 'ui-box';
import { Button } from '../../buttons';
import safeInvoke from '../../lib/safe-invoke';
import { TextInput } from '../../text-input';
export var CLASS_PREFIX = 'evergreen-file-picker';
var FilePicker = /*#__PURE__*/memo( /*#__PURE__*/forwardRef(function FilePicker(props, ref) {
  var accept = props.accept,
      capture = props.capture,
      className = props.className,
      disabled = props.disabled,
      _props$height = props.height,
      height = _props$height === void 0 ? 32 : _props$height,
      multiple = props.multiple,
      name = props.name,
      onBlur = props.onBlur,
      onChange = props.onChange,
      _props$placeholder = props.placeholder,
      placeholder = _props$placeholder === void 0 ? 'Select a file to uploadâ€¦' : _props$placeholder,
      required = props.required,
      rest = _objectWithoutProperties(props, _excluded);

  var _useState = useState([]),
      _useState2 = _slicedToArray(_useState, 2),
      files = _useState2[0],
      setFiles = _useState2[1];

  var fileInputRef = useRef();
  var handleFileChange = useCallback(function (e) {
    // Firefox returns the same array instance each time for some reason
    var filesCopy = _toConsumableArray(e.target.files);

    setFiles(filesCopy);
    safeInvoke(onChange, filesCopy);
  }, [onChange]);
  var handleButtonClick = useCallback(function () {
    if (fileInputRef.current) {
      fileInputRef.current.click();
    }
  }, []);
  var handleBlur = useCallback(function (e) {
    // Setting e.target.files to an array fails. It must be a FileList
    if (e && e.target) {
      e.target.files = fileInputRef.current && fileInputRef.current.files;
    }

    safeInvoke(onBlur, e);
  }, [onBlur]);
  var inputValue;

  if (files.length === 0) {
    inputValue = '';
  } else if (files.length === 1) {
    inputValue = files[0].name;
  } else {
    inputValue = "".concat(files.length, " files");
  }

  var buttonText;

  if (files.length === 0) {
    buttonText = 'Select file';
  } else if (files.length === 1) {
    buttonText = 'Replace file';
  } else {
    buttonText = 'Replace files';
  }

  var rootClassNames = cx("".concat(CLASS_PREFIX, "-root"), className);
  return /*#__PURE__*/React.createElement(Box, _extends({
    display: "flex",
    className: rootClassNames,
    ref: ref
  }, rest), /*#__PURE__*/React.createElement(Box, {
    ref: fileInputRef,
    className: "".concat(CLASS_PREFIX, "-file-input"),
    is: "input",
    type: "file",
    name: name,
    accept: accept,
    required: required,
    multiple: multiple,
    disabled: disabled,
    capture: capture,
    onChange: handleFileChange,
    display: "none"
  }), /*#__PURE__*/React.createElement(TextInput, {
    className: "".concat(CLASS_PREFIX, "-text-input"),
    readOnly: true,
    value: inputValue,
    placeholder: placeholder // There's a weird specifity issue when there's two differently sized inputs on the page
    ,
    borderTopRightRadius: "0 !important",
    borderBottomRightRadius: "0 !important",
    height: height,
    flex: 1,
    textOverflow: "ellipsis",
    onBlur: handleBlur
  }), /*#__PURE__*/React.createElement(Button, {
    className: "".concat(CLASS_PREFIX, "-button"),
    onClick: handleButtonClick,
    disabled: disabled,
    borderTopLeftRadius: 0,
    borderBottomLeftRadius: 0,
    height: height,
    flexShrink: 0,
    type: "button",
    onBlur: handleBlur
  }, buttonText));
}));
FilePicker.propTypes = {
  /**
   * Name attribute of the input.
   */
  name: PropTypes.string,

  /**
   * The accept attribute of the input.
   */
  accept: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),

  /**
   * When true, the file picker is required.
   */
  required: PropTypes.bool,

  /**
   * When true, accept multiple files.
   */
  multiple: PropTypes.bool,

  /**
   * When true, the filepicker is disabled.
   */
  disabled: PropTypes.bool,

  /**
   * The capture attribute of the input.
   */
  capture: PropTypes.bool,

  /**
   * The height of the file picker.
   */
  height: PropTypes.number,

  /**
   * Function called when onChange is fired.
   * (files: FileList) => void
   */
  onChange: PropTypes.func,

  /**
   * Function called when onBlur is fired.
   * (event: React.FocusEvent) => void
   */
  onBlur: PropTypes.func,

  /**
   * Placeholder of the text input
   */
  placeholder: PropTypes.string,

  /**
   * Class name passed to the FilePicker.
   * Only use this if you know what you are doing.
   */
  className: PropTypes.string
};
export default FilePicker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9maWxlLXBpY2tlci9zcmMvRmlsZVBpY2tlci5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsIm1lbW8iLCJmb3J3YXJkUmVmIiwidXNlU3RhdGUiLCJ1c2VSZWYiLCJ1c2VDYWxsYmFjayIsImN4IiwiUHJvcFR5cGVzIiwiQm94IiwiQnV0dG9uIiwic2FmZUludm9rZSIsIlRleHRJbnB1dCIsIkNMQVNTX1BSRUZJWCIsIkZpbGVQaWNrZXIiLCJwcm9wcyIsInJlZiIsImFjY2VwdCIsImNhcHR1cmUiLCJjbGFzc05hbWUiLCJkaXNhYmxlZCIsImhlaWdodCIsIm11bHRpcGxlIiwibmFtZSIsIm9uQmx1ciIsIm9uQ2hhbmdlIiwicGxhY2Vob2xkZXIiLCJyZXF1aXJlZCIsInJlc3QiLCJmaWxlcyIsInNldEZpbGVzIiwiZmlsZUlucHV0UmVmIiwiaGFuZGxlRmlsZUNoYW5nZSIsImUiLCJmaWxlc0NvcHkiLCJ0YXJnZXQiLCJoYW5kbGVCdXR0b25DbGljayIsImN1cnJlbnQiLCJjbGljayIsImhhbmRsZUJsdXIiLCJpbnB1dFZhbHVlIiwibGVuZ3RoIiwiYnV0dG9uVGV4dCIsInJvb3RDbGFzc05hbWVzIiwicHJvcFR5cGVzIiwic3RyaW5nIiwib25lT2ZUeXBlIiwiYXJyYXlPZiIsImJvb2wiLCJudW1iZXIiLCJmdW5jIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU9BLEtBQVAsSUFBZ0JDLElBQWhCLEVBQXNCQyxVQUF0QixFQUFrQ0MsUUFBbEMsRUFBNENDLE1BQTVDLEVBQW9EQyxXQUFwRCxRQUF1RSxPQUF2RTtBQUNBLE9BQU9DLEVBQVAsTUFBZSxZQUFmO0FBQ0EsT0FBT0MsU0FBUCxNQUFzQixZQUF0QjtBQUNBLE9BQU9DLEdBQVAsTUFBZ0IsUUFBaEI7QUFDQSxTQUFTQyxNQUFULFFBQXVCLGVBQXZCO0FBQ0EsT0FBT0MsVUFBUCxNQUF1Qix1QkFBdkI7QUFDQSxTQUFTQyxTQUFULFFBQTBCLGtCQUExQjtBQUVBLE9BQU8sSUFB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ckI7QUFDRjtBQUNBO0FBQ0E7QUFDRTFCLEVBQUFBLE1BQU0sRUFBRWhCLFNBQVMsQ0FBQzBDLElBOUNHOztBQWdEckI7QUFDRjtBQUNBO0FBQ0V4QixFQUFBQSxXQUFXLEVBQUVsQixTQUFTLENBQUNxQyxNQW5ERjs7QUFxRHJCO0FBQ0Y7QUFDQTtBQUNBO0FBQ0UxQixFQUFBQSxTQUFTLEVBQUVYLFNBQVMsQ0FBQ3FDO0FBekRBLENBQXZCO0FBNERBLGVBQWUvQixVQUFmIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IG1lbW8sIGZvcndhcmRSZWYsIHVzZVN0YXRlLCB1c2VSZWYsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgY3ggZnJvbSAnY2xhc3NuYW1lcydcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcydcbmltcG9ydCBCb3ggZnJvbSAndWktYm94J1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vLi4vYnV0dG9ucydcbmltcG9ydCBzYWZlSW52b2tlIGZyb20gJy4uLy4uL2xpYi9zYWZlLWludm9rZSdcbmltcG9ydCB7IFRleHRJbnB1dCB9IGZyb20gJy4uLy4uL3RleHQtaW5wdXQnXG5cbmV4cG9ydCBjb25zdCBDTEFTU19QUkVGSVggPSAnZXZlcmdyZWVuLWZpbGUtcGlja2VyJ1xuXG5jb25zdCBGaWxlUGlja2VyID0gbWVtbyhcbiAgZm9yd2FyZFJlZihmdW5jdGlvbiBGaWxlUGlja2VyKHByb3BzLCByZWYpIHtcbiAgICBjb25zdCB7XG4gICAgICBhY2NlcHQsXG4gICAgICBjYXB0dXJlLFxuICAgICAgY2xhc3NOYW1lLFxuICAgICAgZGlzYWJsZWQsXG4gICAgICBoZWlnaHQgPSAzMixcbiAgICAgIG11bHRpcGxlLFxuICAgICAgbmFtZSxcbiAgICAgIG9uQmx1cixcbiAgICAgIG9uQ2hhbmdlLFxuICAgICAgcGxhY2Vob2xkZXIgPSAnU2VsZWN0IGEgZmlsZSB0byB1cGxvYWTigKYnLFxuICAgICAgcmVxdWlyZWQsXG4gICAgICAuLi5yZXN0XG4gICAgfSA9IHByb3BzXG5cbiAgICBjb25zdCBbZmlsZXMsIHNldEZpbGVzXSA9IHVzZVN0YXRlKFtdKVxuICAgIGNvbnN0IGZpbGVJbnB1dFJlZiA9IHVzZVJlZigpXG5cbiAgICBjb25zdCBoYW5kbGVGaWxlQ2hhbmdlID0gdXNlQ2FsbGJhY2soXG4gICAgICBlID0+IHtcbiAgICAgICAgLy8gRmlyZWZveCByZXR1cm5zIHRoZSBzYW1lIGFycmF5IGluc3RhbmNlIGVhY2ggdGltZSBmb3Igc29tZSByZWFzb25cbiAgICAgICAgY29uc3QgZmlsZXNDb3B5ID0gWy4uLmUudGFyZ2V0LmZpbGVzXVxuXG4gICAgICAgIHNldEZpbGVzKGZpbGVzQ29weSlcblxuICAgICAgICBzYWZlSW52b2tlKG9uQ2hhbmdlLCBmaWxlc0NvcHkpXG4gICAgICB9LFxuICAgICAgW29uQ2hhbmdlXVxuICAgIClcblxuICAgIGNvbnN0IGhhbmRsZUJ1dHRvbkNsaWNrID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgaWYgKGZpbGVJbnB1dFJlZi5jdXJyZW50KSB7XG4gICAgICAgIGZpbGVJbnB1dFJlZi5jdXJyZW50LmNsaWNrKClcbiAgICAgIH1cbiAgICB9LCBbXSlcblxuICAgIGNvbnN0IGhhbmRsZUJsdXIgPSB1c2VDYWxsYmFjayhcbiAgICAgIGUgPT4ge1xuICAgICAgICAvLyBTZXR0aW5nIGUudGFyZ2V0LmZpbGVzIHRvIGFuIGFycmF5IGZhaWxzLiBJdCBtdXN0IGJlIGEgRmlsZUxpc3RcbiAgICAgICAgaWYgKGUgJiYgZS50YXJnZXQpIHtcbiAgICAgICAgICBlLnRhcmdldC5maWxlcyA9IGZpbGVJbnB1dFJlZi5jdXJyZW50ICYmIGZpbGVJbnB1dFJlZi5jdXJyZW50LmZpbGVzXG4gICAgICAgIH1cblxuICAgICAgICBzYWZlSW52b2tlKG9uQmx1ciwgZSlcbiAgICAgIH0sXG4gICAgICBbb25CbHVyXVxuICAgIClcblxuICAgIGxldCBpbnB1dFZhbHVlXG4gICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgaW5wdXRWYWx1ZSA9ICcnXG4gICAgfSBlbHNlIGlmIChmaWxlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgIGlucHV0VmFsdWUgPSBmaWxlc1swXS5uYW1lXG4gICAgfSBlbHNlIHtcbiAgICAgIGlucHV0VmFsdWUgPSBgJHtmaWxlcy5sZW5ndGh9IGZpbGVzYFxuICAgIH1cblxuICAgIGxldCBidXR0b25UZXh0XG4gICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgYnV0dG9uVGV4dCA9ICdTZWxlY3QgZmlsZSdcbiAgICB9IGVsc2UgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgYnV0dG9uVGV4dCA9ICdSZXBsYWNlIGZpbGUnXG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvblRleHQgPSAnUmVwbGFjZSBmaWxlcydcbiAgICB9XG5cbiAgICBjb25zdCByb290Q2xhc3NOYW1lcyA9IGN4KGAke0NMQVNTX1BSRUZJWH0tcm9vdGAsIGNsYXNzTmFtZSlcblxuICAgIHJldHVybiAoXG4gICAgICA8Qm94IGRpc3BsYXk9XCJmbGV4XCIgY2xhc3NOYW1lPXtyb290Q2xhc3NOYW1lc30gcmVmPXtyZWZ9IHsuLi5yZXN0fT5cbiAgICAgICAgPEJveFxuICAgICAgICAgIHJlZj17ZmlsZUlucHV0UmVmfVxuICAgICAgICAgIGNsYXNzTmFtZT17YCR7Q0xBU1NfUFJFRklYfS1maWxlLWlucHV0YH1cbiAgICAgICAgICBpcz1cImlucHV0XCJcbiAgICAgICAgICB0eXBlPVwiZmlsZVwiXG4gICAgICAgICAgbmFtZT17bmFtZX1cbiAgICAgICAgICBhY2NlcHQ9e2FjY2VwdH1cbiAgICAgICAgICByZXF1aXJlZD17cmVxdWlyZWR9XG4gICAgICAgICAgbXVsdGlwbGU9e211bHRpcGxlfVxuICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICBjYXB0dXJlPXtjYXB0dXJlfVxuICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVGaWxlQ2hhbmdlfVxuICAgICAgICAgIGRpc3BsYXk9XCJub25lXCJcbiAgICAgICAgLz5cblxuICAgICAgICA8VGV4dElucHV0XG4gICAgICAgICAgY2xhc3NOYW1lPXtgJHtDTEFTU19QUkVGSVh9LXRleHQtaW5wdXRgfVxuICAgICAgICAgIHJlYWRPbmx5XG4gICAgICAgICAgdmFsdWU9e2lucHV0VmFsdWV9XG4gICAgICAgICAgcGxhY2Vob2xkZXI9e3BsYWNlaG9sZGVyfVxuICAgICAgICAgIC8vIFRoZXJlJ3MgYSB3ZWlyZCBzcGVjaWZpdHkgaXNzdWUgd2hlbiB0aGVyZSdzIHR3byBkaWZmZXJlbnRseSBzaXplZCBpbnB1dHMgb24gdGhlIHBhZ2VcbiAgICAgICAgICBib3JkZXJUb3BSaWdodFJhZGl1cz1cIjAgIWltcG9ydGFudFwiXG4gICAgICAgICAgYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM9XCIwICFpbXBvcnRhbnRcIlxuICAgICAgICAgIGhlaWdodD17aGVpZ2h0fVxuICAgICAgICAgIGZsZXg9ezF9XG4gICAgICAgICAgdGV4dE92ZXJmbG93PVwiZWxsaXBzaXNcIlxuICAgICAgICAgIG9uQmx1cj17aGFuZGxlQmx1cn1cbiAgICAgICAgLz5cblxuICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgY2xhc3NOYW1lPXtgJHtDTEFTU19QUkVGSVh9LWJ1dHRvbmB9XG4gICAgICAgICAgb25DbGljaz17aGFuZGxlQnV0dG9uQ2xpY2t9XG4gICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgIGJvcmRlclRvcExlZnRSYWRpdXM9ezB9XG4gICAgICAgICAgYm9yZGVyQm90dG9tTGVmdFJhZGl1cz17MH1cbiAgICAgICAgICBoZWlnaHQ9e2hlaWdodH1cbiAgICAgICAgICBmbGV4U2hyaW5rPXswfVxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgIG9uQmx1cj17aGFuZGxlQmx1cn1cbiAgICAgICAgPlxuICAgICAgICAgIHtidXR0b25UZXh0fVxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgIDwvQm94PlxuICAgIClcbiAgfSlcbilcblxuRmlsZVBpY2tlci5wcm9wVHlwZXMgPSB7XG4gIC8qKlxuICAgKiBOYW1lIGF0dHJpYnV0ZSBvZiB0aGUgaW5wdXQuXG4gICAqL1xuICBuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuXG4gIC8qKlxuICAgKiBUaGUgYWNjZXB0IGF0dHJpYnV0ZSBvZiB0aGUgaW5wdXQuXG4gICAqL1xuICBhY2NlcHQ6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zdHJpbmcpXSksXG5cbiAgLyoqXG4gICAqIFdoZW4gdHJ1ZSwgdGhlIGZpbGUgcGlja2VyIGlzIHJlcXVpcmVkLlxuICAgKi9cbiAgcmVxdWlyZWQ6IFByb3BUeXBlcy5ib29sLFxuXG4gIC8qKlxuICAgKiBXaGVuIHRydWUsIGFjY2VwdCBtdWx0aXBsZSBmaWxlcy5cbiAgICovXG4gIG11bHRpcGxlOiBQcm9wVHlwZXMuYm9vbCxcblxuICAvKipcbiAgICogV2hlbiB0cnVlLCB0aGUgZmlsZXBpY2tlciBpcyBkaXNhYmxlZC5cbiAgICovXG4gIGRpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcblxuICAvKipcbiAgICogVGhlIGNhcHR1cmUgYXR0cmlidXRlIG9mIHRoZSBpbnB1dC5cbiAgICovXG4gIGNhcHR1cmU6IFByb3BUeXBlcy5ib29sLFxuXG4gIC8qKlxuICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSBmaWxlIHBpY2tlci5cbiAgICovXG4gIGhlaWdodDogUHJvcFR5cGVzLm51bWJlcixcblxuICAvKipcbiAgICogRnVuY3Rpb24gY2FsbGVkIHdoZW4gb25DaGFuZ2UgaXMgZmlyZWQuXG4gICAqIChmaWxlczogRmlsZUxpc3QpID0+IHZvaWRcbiAgICovXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcblxuICAvKipcbiAgICogRnVuY3Rpb24gY2FsbGVkIHdoZW4gb25CbHVyIGlzIGZpcmVkLlxuICAgKiAoZXZlbnQ6IFJlYWN0LkZvY3VzRXZlbnQpID0+IHZvaWRcbiAgICovXG4gIG9uQmx1cjogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgLyoqXG4gICAqIFBsYWNlaG9sZGVyIG9mIHRoZSB0ZXh0IGlucHV0XG4gICAqL1xuICBwbGFjZWhvbGRlcjogUHJvcFR5cGVzLnN0cmluZyxcblxuICAvKipcbiAgICogQ2xhc3MgbmFtZSBwYXNzZWQgdG8gdGhlIEZpbGVQaWNrZXIuXG4gICAqIE9ubHkgdXNlIHRoaXMgaWYgeW91IGtub3cgd2hhdCB5b3UgYXJlIGRvaW5nLlxuICAgKi9cbiAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nXG59XG5cbmV4cG9ydCBkZWZhdWx0IEZpbGVQaWNrZXJcbiJdfQ==