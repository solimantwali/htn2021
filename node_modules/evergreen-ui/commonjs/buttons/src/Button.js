"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _typeof = require("@babel/runtime/helpers/typeof");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.getIconSizeForButton = exports.pseudoSelectors = exports.internalStyles = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _uiBox = _interopRequireWildcard(require("ui-box"));

var _hooks = require("../../hooks");

var _IconWrapper = require("../../icons/src/IconWrapper");

var _deprecatedThemeHelpers = require("../../lib/deprecated-theme-helpers");

var _spinner = require("../../spinner");

var _excluded = ["appearance", "children", "className", "color", "disabled", "iconAfter", "iconBefore", "intent", "is", "isActive", "isLoading"],
    _excluded2 = ["className"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

/* eslint-disable react/prop-types */
var ButtonIcon = /*#__PURE__*/(0, _react.memo)(function ButtonIcon(_ref) {
  var edge = _ref.edge,
      icon = _ref.icon,
      size = _ref.size,
      spacing = _ref.spacing;
  if (!icon) return null;
  var relativeSpace = typeof spacing === 'number' ? spacing : size;
  var edgeMargin = -Math.round(relativeSpace * 0.25);
  var innerMargin = Math.round(size * 0.7);
  var marginLeft = edge === 'start' ? edgeMargin : innerMargin;
  var marginRight = edge === 'end' ? edgeMargin : innerMargin;
  return /*#__PURE__*/_react["default"].createElement(_IconWrapper.IconWrapper, {
    icon: icon,
    size: size,
    marginLeft: marginLeft,
    marginRight: marginRight
  });
});
/* eslint-enable react/prop-types */

var internalStyles = {
  position: 'relative',
  fontWeight: 500,
  display: 'inline-flex',
  alignItems: 'center',
  flexWrap: 'nowrap',
  justifyContent: 'center',
  textDecoration: 'none',
  verticalAlign: 'middle',
  border: 'none',
  outline: 'none',
  userSelect: 'none',
  cursor: 'pointer',
  whiteSpace: 'nowrap',
  WebkitFontSmoothing: 'antialiased',
  WebkitAppearance: 'none',
  MozAppearance: 'none',
  '&::-moz-focus-inner ': {
    border: 0
  }
};
exports.internalStyles = internalStyles;
var pseudoSelectors = {
  _active: '&:not([disabled]):active, &:not([disabled])[aria-expanded="true"], &:not([disabled])[data-active]',
  _disabled: '&[disabled]',
  _focus: '&:not([disabled]):focus',
  _focusAndActive: '&:not([disabled]):focus:active, &:not([disabled])[aria-expanded="true"]:focus, &:not([disabled])[data-active]:focus',
  _hover: '&:not([disabled]):hover'
};
exports.pseudoSelectors = pseudoSelectors;

var getIconSizeForButton = function getIconSizeForButton(height) {
  if (height <= 28) return 12;
  if (height <= 32) return 14;
  if (height <= 40) return 16;
  if (height <= 48) return 18;
  return 20;
};

exports.getIconSizeForButton = getIconSizeForButton;
var Button = /*#__PURE__*/(0, _react.memo)( /*#__PURE__*/(0, _react.forwardRef)(function Button(props, ref) {
  var _props$appearance = props.appearance,
      appearance = _props$appearance === void 0 ? 'default' : _props$appearance,
      children = props.children,
      className = props.className,
      color = props.color,
      disabled = props.disabled,
      iconAfter = props.iconAfter,
      iconBefore = props.iconBefore,
      _props$intent = props.intent,
      intent = _props$intent === void 0 ? 'none' : _props$intent,
      _props$is = props.is,
      is = _props$is === void 0 ? 'button' : _props$is,
      _props$isActive = props.isActive,
      isActive = _props$isActive === void 0 ? false : _props$isActive,
      isLoading = props.isLoading,
      restProps = (0, _objectWithoutProperties2["default"])(props, _excluded);

  var _useStyleConfig = (0, _hooks.useStyleConfig)('Button', {
    appearance: appearance,
    color: color,
    intent: intent,
    size: restProps.size || 'medium'
  }, pseudoSelectors, internalStyles),
      themedClassName = _useStyleConfig.className,
      boxProps = (0, _objectWithoutProperties2["default"])(_useStyleConfig, _excluded2);

  var height = restProps.height || boxProps.height; // Keep backwards compat font sizing if an explicit height was passed in.

  var textProps = !restProps.size && restProps.height ? (0, _deprecatedThemeHelpers.getTextPropsForControlHeight)(restProps.height) : {};
  var iconSize = getIconSizeForButton(height);
  return /*#__PURE__*/_react["default"].createElement(_uiBox["default"], (0, _extends2["default"])({
    is: is,
    ref: ref,
    className: (0, _classnames["default"])(themedClassName, className),
    "data-active": isActive || undefined
  }, boxProps, restProps, textProps, {
    disabled: disabled || isLoading
  }), isLoading && /*#__PURE__*/_react["default"].createElement(_spinner.Spinner, {
    marginLeft: -Math.round(height / 8),
    marginRight: Math.round(height / 4),
    size: Math.round(height / 2)
  }), /*#__PURE__*/_react["default"].createElement(ButtonIcon, {
    icon: iconBefore,
    size: iconSize,
    spacing: restProps.paddingLeft,
    edge: "start"
  }), children, /*#__PURE__*/_react["default"].createElement(ButtonIcon, {
    icon: iconAfter,
    size: iconSize,
    spacing: restProps.paddingRight,
    edge: "end"
  }));
}));
Button.propTypes = _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, _uiBox.dimensions.propTypes), _uiBox.spacing.propTypes), _uiBox.position.propTypes), _uiBox.layout.propTypes), {}, {
  /**
   * The appearance of the button.
   */
  appearance: _propTypes["default"].oneOf(['default', 'minimal', 'primary']),

  /**
   * The size of the button
   */
  size: _propTypes["default"].oneOf(['small', 'medium', 'large']),

  /**
   * When true, show a loading spinner before the children.
   * This also disables the button.
   */
  isLoading: _propTypes["default"].bool,

  /**
   * Forcefully set the active state of a button.
   * Useful in conjunction with a Popover.
   */
  isActive: _propTypes["default"].bool,

  /**
   * Sets an icon before the text. Can be any icon from Evergreen or a custom element.
   */
  iconBefore: _propTypes["default"].oneOfType([_propTypes["default"].elementType, _propTypes["default"].element]),

  /**
   * Sets an icon after the text. Can be any icon from Evergreen or a custom element.
   */
  iconAfter: _propTypes["default"].oneOfType([_propTypes["default"].elementType, _propTypes["default"].element]),

  /**
   * When true, the button is disabled.
   * isLoading also sets the button to disabled.
   */
  disabled: _propTypes["default"].bool,

  /**
   * Class name passed to the button.
   * Only use if you know what you are doing.
   */
  className: _propTypes["default"].string
});
var _default = Button;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9idXR0b25zL3NyYy9CdXR0b24uanMiXSwibmFtZXMiOlsiQnV0dG9uSWNvbiIsImVkZ2UiLCJpY29uIiwic2l6ZSIsInNwYWNpbmciLCJyZWxhdGl2ZVNwYWNlIiwiZWRnZU1hcmdpbiIsIk1hdGgiLCJyb3VuZCIsImlubmVyTWFyZ2luIiwibWFyZ2luTGVmdCIsIm1hcmdpblJpZ2h0IiwiaW50ZXJuYWxTdHlsZXMiLCJwb3NpdGlvbiIsImZvbnRXZWlnaHQiLCJkaXNwbGF5IiwiYWxpZ25JdGVtcyIsImZsZXhXcmFwIiwianVzdGlmeUNvbnRlbnQiLCJ0ZXh0RGVjb3JhdGlvbiIsInZlcnRpY2FsQWxpZ24iLCJib3JkZXIiLCJvdXRsaW5lIiwidXNlclNlbGVjdCIsImN1cnNvciIsIndoaXRlU3BhY2UiLCJXZWJraXRGb250U21vb3RoaW5nIiwiV2Via2l0QXBwZWFyYW5jZSIsIk1vekFwcGVhcmFuY2UiLCJwc2V1ZG9TZWxlY3RvcnMiLCJfYWN0aXZlIiwiX2Rpc2FibGVkIiwiX2ZvY3VzIiwiX2ZvY3VzQW5kQWN0aXZlIiwiX2hvdmVyIiwiZ2V0SWNvblNpemVGb3JCdXR0b24iLCJoZWlnaHQiLCJCdXR0b24iLCJwcm9wcyIsInJlZiIsImFwcGVhcmFuY2UiLCJjaGlsZHJlbiIsImNsYXNzTmFtZSIsImNvbG9yIiwiZGlzYWJsZWQiLCJpY29uQWZ0ZXIiLCJpY29uQmVmb3JlIiwiaW50ZW50IiwiaXMiLCJpc0FjdGl2ZSIsImlzTG9hZGluZyIsInJlc3RQcm9wcyIsInRoZW1lZENsYXNzTmFtZSIsImJveFByb3BzIiwidGV4dFByb3BzIiwiaWNvblNpemUiLCJ1bmRlZmluZWQiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCIsInByb3BUeXBlcyIsImRpbWVuc2lvbnMiLCJsYXlvdXQiLCJQcm9wVHlwZXMiLCJvbmVPZiIsImJvb2wiLCJvbmVPZlR5cGUiLCJlbGVtZW50VHlwZSIsImVsZW1lbnQiLCJzdHJpbmciXSwibWFw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bXBvcnQgY3ggZnJvbSAnY2xhc3NuYW1lcydcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcydcbmltcG9ydCBCb3gsIHsgc3BhY2luZywgZGltZW5zaW9ucywgcG9zaXRpb24sIGxheW91dCB9IGZyb20gJ3VpLWJveCdcbmltcG9ydCB7IHVzZVN0eWxlQ29uZmlnIH0gZnJvbSAnLi4vLi4vaG9va3MnXG5pbXBvcnQgeyBJY29uV3JhcHBlciB9IGZyb20gJy4uLy4uL2ljb25zL3NyYy9JY29uV3JhcHBlcidcbmltcG9ydCB7IGdldFRleHRQcm9wc0ZvckNvbnRyb2xIZWlnaHQgfSBmcm9tICcuLi8uLi9saWIvZGVwcmVjYXRlZC10aGVtZS1oZWxwZXJzJ1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uLy4uL3NwaW5uZXInXG5cbi8qIGVzbGludC1kaXNhYmxlIHJlYWN0L3Byb3AtdHlwZXMgKi9cbmNvbnN0IEJ1dHRvbkljb24gPSBtZW1vKGZ1bmN0aW9uIEJ1dHRvbkljb24oeyBlZGdlLCBpY29uLCBzaXplLCBzcGFjaW5nIH0pIHtcbiAgaWYgKCFpY29uKSByZXR1cm4gbnVsbFxuXG4gIGNvbnN0IHJlbGF0aXZlU3BhY2UgPSB0eXBlb2Ygc3BhY2luZyA9PT0gJ251bWJlcicgPyBzcGFjaW5nIDogc2l6ZVxuICBjb25zdCBlZGdlTWFyZ2luID0gLU1hdGgucm91bmQocmVsYXRpdmVTcGFjZSAqIDAuMjUpXG4gIGNvbnN0IGlubmVyTWFyZ2luID0gTWF0aC5yb3VuZChzaXplICogMC43KVxuICBjb25zdCBtYXJnaW5MZWZ0ID0gZWRnZSA9PT0gJ3N0YXJ0JyA/IGVkZ2VNYXJnaW4gOiBpbm5lck1hcmdpblxuICBjb25zdCBtYXJnaW5SaWdodCA9IGVkZ2UgPT09ICdlbmQnID8gZWRnZU1hcmdpbiA6IGlubmVyTWFyZ2luXG5cbiAgcmV0dXJuIDxJY29uV3JhcHBlciBpY29uPXtpY29ufSBzaXplPXtzaXplfSBtYXJnaW5MZWZ0PXttYXJnaW5MZWZ0fSBtYXJnaW5SaWdodD17bWFyZ2luUmlnaHR9IC8+XG59KVxuLyogZXNsaW50LWVuYWJsZSByZWFjdC9wcm9wLXR5cGVzICovXG5cbmV4cG9ydCBjb25zdCBpbnRlcm5hbFN0eWxlcyA9IHtcbiAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gIGZvbnRXZWlnaHQ6IDUwMCxcbiAgZGlzcGxheTogJ2lubGluZS1mbGV4JyxcbiAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gIGZsZXhXcmFwOiAnbm93cmFwJyxcbiAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICB0ZXh0RGVjb3JhdGlvbjogJ25vbmUnLFxuICB2ZXJ0aWNhbEFsaWduOiAnbWlkZGxlJyxcbiAgYm9yZGVyOiAnbm9uZScsXG4gIG91dGxpbmU6ICdub25lJyxcbiAgdXNlclNlbGVjdDogJ25vbmUnLFxuICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgd2hpdGVTcGFjZTogJ25vd3JhcCcsXG4gIFdlYmtpdEZvbnRTbW9vdGhpbmc6ICdhbnRpYWxpYXNlZCcsXG4gIFdlYmtpdEFwcGVhcmFuY2U6ICdub25lJyxcbiAgTW96QXBwZWFyYW5jZTogJ25vbmUnLFxuICAnJjo6LW1vei1mb2N1cy1pbm5lciAnOiB7XG4gICAgYm9yZGVyOiAwXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHBzZXVkb1NlbGVjdG9ycyA9IHtcbiAgX2FjdGl2ZTogJyY6bm90KFtkaXNhYmxlZF0pOmFjdGl2ZSwgJjpub3QoW2Rpc2FibGVkXSlbYXJpYS1leHBhbmRlZD1cInRydWVcIl0sICY6bm90KFtkaXNhYmxlZF0pW2RhdGEtYWN0aXZlXScsXG4gIF9kaXNhYmxlZDogJyZbZGlzYWJsZWRdJyxcbiAgX2ZvY3VzOiAnJjpub3QoW2Rpc2FibGVkXSk6Zm9jdXMnLFxuICBfZm9jdXNBbmRBY3RpdmU6XG4gICAgJyY6bm90KFtkaXNhYmxlZF0pOmZvY3VzOmFjdGl2ZSwgJjpub3QoW2Rpc2FibGVkXSlbYXJpYS1leHBhbmRlZD1cInRydWVcIl06Zm9jdXMsICY6bm90KFtkaXNhYmxlZF0pW2RhdGEtYWN0aXZlXTpmb2N1cycsXG4gIF9ob3ZlcjogJyY6bm90KFtkaXNhYmxlZF0pOmhvdmVyJ1xufVxuXG5leHBvcnQgY29uc3QgZ2V0SWNvblNpemVGb3JCdXR0b24gPSBoZWlnaHQgPT4ge1xuICBpZiAoaGVpZ2h0IDw9IDI4KSByZXR1cm4gMTJcbiAgaWYgKGhlaWdodCA8PSAzMikgcmV0dXJuIDE0XG4gIGlmIChoZWlnaHQgPD0gNDApIHJldHVybiAxNlxuICBpZiAoaGVpZ2h0IDw9IDQ4KSByZXR1cm4gMThcbiAgcmV0dXJuIDIwXG59XG5cbmNvbnN0IEJ1dHRvbiA9IG1lbW8oXG4gIGZvcndhcmRSZWYoZnVuY3Rpb24gQnV0dG9uKHByb3BzLCByZWYpIHtcbiAgICBjb25zdCB7XG4gICAgICBhcHBlYXJhbmNlID0gJ2RlZmF1bHQnLFxuICAgICAgY2hpbGRyZW4sXG4gICAgICBjbGFzc05hbWUsXG4gICAgICBjb2xvcixcbiAgICAgIGRpc2FibGVkLFxuICAgICAgaWNvbkFmdGVyLFxuICAgICAgaWNvbkJlZm9yZSxcbiAgICAgIGludGVudCA9ICdub25lJyxcbiAgICAgIGlzID0gJ2J1dHRvbicsXG4gICAgICBpc0FjdGl2ZSA9IGZhbHNlLFxuICAgICAgaXNMb2FkaW5nLFxuICAgICAgLi4ucmVzdFByb3BzXG4gICAgfSA9IHByb3BzXG5cbiAgICBjb25zdCB7IGNsYXNzTmFtZTogdGhlbWVkQ2xhc3NOYW1lLCAuLi5ib3hQcm9wcyB9ID0gdXNlU3R5bGVDb25maWcoXG4gICAgICAnQnV0dG9uJyxcbiAgICAgIHsgYXBwZWFyYW5jZSwgY29sb3IsIGludGVudCwgc2l6ZTogcmVzdFByb3BzLnNpemUgfHwgJ21lZGl1bScgfSxcbiAgICAgIHBzZXVkb1NlbGVjdG9ycyxcbiAgICAgIGludGVybmFsU3R5bGVzXG4gICAgKVxuXG4gICAgY29uc3QgaGVpZ2h0ID0gcmVzdFByb3BzLmhlaWdodCB8fCBib3hQcm9wcy5oZWlnaHRcbiAgICAvLyBLZWVwIGJhY2t3YXJkcyBjb21wYXQgZm9udCBzaXppbmcgaWYgYW4gZXhwbGljaXQgaGVpZ2h0IHdhcyBwYXNzZWQgaW4uXG4gICAgY29uc3QgdGV4dFByb3BzID0gIXJlc3RQcm9wcy5zaXplICYmIHJlc3RQcm9wcy5oZWlnaHQgPyBnZXRUZXh0UHJvcHNGb3JDb250cm9sSGVpZ2h0KHJlc3RQcm9wcy5oZWlnaHQpIDoge31cbiAgICBjb25zdCBpY29uU2l6ZSA9IGdldEljb25TaXplRm9yQnV0dG9uKGhlaWdodClcblxuICAgIHJldHVybiAoXG4gICAgICA8Qm94XG4gICAgICAgIGlzPXtpc31cbiAgICAgICAgcmVmPXtyZWZ9XG4gICAgICAgIGNsYXNzTmFtZT17Y3godGhlbWVkQ2xhc3NOYW1lLCBjbGFzc05hbWUpfVxuICAgICAgICBkYXRhLWFjdGl2ZT17aXNBY3RpdmUgfHwgdW5kZWZpbmVkfVxuICAgICAgICB7Li4uYm94UHJvcHN9XG4gICAgICAgIHsuLi5yZXN0UHJvcHN9XG4gICAgICAgIHsuLi50ZXh0UHJvcHN9XG4gICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZCB8fCBpc0xvYWRpbmd9XG4gICAgICA+XG4gICAgICAgIHtpc0xvYWRpbmcgJiYgKFxuICAgICAgICAgIDxTcGlubmVyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0PXstTWF0aC5yb3VuZChoZWlnaHQgLyA4KX1cbiAgICAgICAgICAgIG1hcmdpblJpZ2h0PXtNYXRoLnJvdW5kKGhlaWdodCAvIDQpfVxuICAgICAgICAgICAgc2l6ZT17TWF0aC5yb3VuZChoZWlnaHQgLyAyKX1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8QnV0dG9uSWNvbiBpY29uPXtpY29uQmVmb3JlfSBzaXplPXtpY29uU2l6ZX0gc3BhY2luZz17cmVzdFByb3BzLnBhZGRpbmdMZWZ0fSBlZGdlPVwic3RhcnRcIiAvPlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICAgIDxCdXR0b25JY29uIGljb249e2ljb25BZnRlcn0gc2l6ZT17aWNvblNpemV9IHNwYWNpbmc9e3Jlc3RQcm9wcy5wYWRkaW5nUmlnaHR9IGVkZ2U9XCJlbmRcIiAvPlxuICAgICAgPC9Cb3g+XG4gICAgKVxuICB9KVxuKVxuXG5CdXR0b24ucHJvcFR5cGVzID0ge1xuICAvKipcbiAgICogQ29tcG9zZXMgdGhlIGRpbWVuc2lvbnMgc3BlYyBmcm9tIHRoZSBCb3ggcHJpbWl0aXZlLlxuICAgKi9cbiAgLi4uZGltZW5zaW9ucy5wcm9wVHlwZXMsXG5cbiAgLyoqXG4gICAqIENvbXBvc2VzIHRoZSBzcGFjaW5nIHNwZWMgZnJvbSB0aGUgQm94IHByaW1pdGl2ZS5cbiAgICovXG4gIC4uLnNwYWNpbmcucHJvcFR5cGVzLFxuXG4gIC8qKlxuICAgKiBDb21wb3NlcyB0aGUgcG9zaXRpb24gc3BlYyBmcm9tIHRoZSBCb3ggcHJpbWl0aXZlLlxuICAgKi9cbiAgLi4ucG9zaXRpb24ucHJvcFR5cGVzLFxuXG4gIC8qKlxuICAgKiBDb21wb3NlcyB0aGUgbGF5b3V0IHNwZWMgZnJvbSB0aGUgQm94IHByaW1pdGl2ZS5cbiAgICovXG4gIC4uLmxheW91dC5wcm9wVHlwZXMsXG5cbiAgLyoqXG4gICAqIFRoZSBhcHBlYXJhbmNlIG9mIHRoZSBidXR0b24uXG4gICAqL1xuICBhcHBlYXJhbmNlOiBQcm9wVHlwZXMub25lT2YoWydkZWZhdWx0JywgJ21pbmltYWwnLCAncHJpbWFyeSddKSxcblxuICAvKipcbiAgICogVGhlIHNpemUgb2YgdGhlIGJ1dHRvblxuICAgKi9cbiAgc2l6ZTogUHJvcFR5cGVzLm9uZU9mKFsnc21hbGwnLCAnbWVkaXVtJywgJ2xhcmdlJ10pLFxuXG4gIC8qKlxuICAgKiBXaGVuIHRydWUsIHNob3cgYSBsb2FkaW5nIHNwaW5uZXIgYmVmb3JlIHRoZSBjaGlsZHJlbi5cbiAgICogVGhpcyBhbHNvIGRpc2FibGVzIHRoZSBidXR0b24uXG4gICAqL1xuICBpc0xvYWRpbmc6IFByb3BUeXBlcy5ib29sLFxuXG4gIC8qKlxuICAgKiBGb3JjZWZ1bGx5IHNldCB0aGUgYWN0aXZlIHN0YXRlIG9mIGEgYnV0dG9uLlxuICAgKiBVc2VmdWwgaW4gY29uanVuY3Rpb24gd2l0aCBhIFBvcG92ZXIuXG4gICAqL1xuICBpc0FjdGl2ZTogUHJvcFR5cGVzLmJvb2wsXG5cbiAgLyoqXG4gICAqIFNldHMgYW4gaWNvbiBiZWZvcmUgdGhlIHRleHQuIENhbiBiZSBhbnkgaWNvbiBmcm9tIEV2ZXJncmVlbiBvciBhIGN1c3RvbSBlbGVtZW50LlxuICAgKi9cbiAgaWNvbkJlZm9yZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmVsZW1lbnRUeXBlLCBQcm9wVHlwZXMuZWxlbWVudF0pLFxuXG4gIC8qKlxuICAgKiBTZXRzIGFuIGljb24gYWZ0ZXIgdGhlIHRleHQuIENhbiBiZSBhbnkgaWNvbiBmcm9tIEV2ZXJncmVlbiBvciBhIGN1c3RvbSBlbGVtZW50LlxuICAgKi9cbiAgaWNvbkFmdGVyOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZWxlbWVudFR5cGUsIFByb3BUeXBlcy5lbGVtZW50XSksXG5cbiAgLyoqXG4gICAqIFdoZW4gdHJ1ZSwgdGhlIGJ1dHRvbiBpcyBkaXNhYmxlZC5cbiAgICogaXNMb2FkaW5nIGFsc28gc2V0cyB0aGUgYnV0dG9uIHRvIGRpc2FibGVkLlxuICAgKi9cbiAgZGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sLFxuXG4gIC8qKlxuICAgKiBDbGFzcyBuYW1lIHBhc3NlZCB0byB0aGUgYnV0dG9uLlxuICAgKiBPbmx5IHVzZSBpZiB5b3Uga25vdyB3aGF0IHlvdSBhcmUgZG9pbmcuXG4gICAqL1xuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmdcbn1cblxuZXhwb3J0IGRlZmF1bHQgQnV0dG9uXG4iXX0=