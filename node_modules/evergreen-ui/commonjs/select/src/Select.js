"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _typeof = require("@babel/runtime/helpers/typeof");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _uiBox = _interopRequireWildcard(require("ui-box"));

var _hooks = require("../../hooks");

var _icons = require("../../icons");

var _deprecatedThemeHelpers = require("../../lib/deprecated-theme-helpers");

var _excluded = ["appearance", "autoFocus", "children", "defaultValue", "disabled", "height", "id", "isInvalid", "name", "onChange", "required", "value"],
    _excluded2 = ["className"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var internalStyles = {
  textTransform: 'default',
  WebkitAppearance: 'none',
  MozAppearance: 'none',
  border: 'none',
  flex: 1,
  background: 'none',
  width: '100%',
  WebkitFontSmoothing: 'antialiased',
  textDecoration: 'none',
  outline: 'none',
  cursor: 'pointer',
  ':-moz-focusring': {
    color: 'transparent',
    textShadow: '0 0 0 #000'
  }
};
var pseudoSelectors = {
  _disabled: '[disabled]',
  _invalid: '&[aria-invalid="true"]',
  _hover: '&:not([disabled]):hover',
  _focus: '&:not([disabled]):focus',
  _active: '&:not([disabled]):active'
};

var getIconSizeForSelect = function getIconSizeForSelect(height) {
  if (height <= 28) return 12;
  if (height <= 32) return 14; // Slightly bigger than getIconSizeForButton

  if (height <= 40) return 16;
  if (height <= 48) return 18;
  return 20;
};

var Select = /*#__PURE__*/(0, _react.memo)( /*#__PURE__*/(0, _react.forwardRef)(function Select(props, ref) {
  var _props$appearance = props.appearance,
      appearance = _props$appearance === void 0 ? 'default' : _props$appearance,
      autoFocus = props.autoFocus,
      children = props.children,
      defaultValue = props.defaultValue,
      disabled = props.disabled,
      heightProp = props.height,
      id = props.id,
      _props$isInvalid = props.isInvalid,
      isInvalid = _props$isInvalid === void 0 ? false : _props$isInvalid,
      name = props.name,
      onChange = props.onChange,
      required = props.required,
      value = props.value,
      restProps = (0, _objectWithoutProperties2["default"])(props, _excluded);

  var _useStyleConfig = (0, _hooks.useStyleConfig)('Select', {
    appearance: appearance,
    size: restProps.size || 'medium'
  }, pseudoSelectors, internalStyles),
      themedClassName = _useStyleConfig.className,
      boxProps = (0, _objectWithoutProperties2["default"])(_useStyleConfig, _excluded2);

  var height = heightProp || boxProps.height;
  var textProps = !restProps.size && restProps.height ? (0, _deprecatedThemeHelpers.getTextPropsForControlHeight)(restProps.height) : {};
  var iconSize = getIconSizeForSelect(height);
  var iconMargin = height >= 36 ? 12 : 8;
  return /*#__PURE__*/_react["default"].createElement(_uiBox["default"], (0, _extends2["default"])({
    ref: ref,
    display: "inline-flex",
    flex: 1,
    position: "relative",
    width: "auto",
    height: height
  }, restProps, textProps), /*#__PURE__*/_react["default"].createElement(_uiBox["default"], (0, _extends2["default"])({
    is: "select",
    className: themedClassName,
    id: id,
    name: name,
    onChange: onChange,
    defaultValue: defaultValue,
    value: value,
    required: required,
    autoFocus: autoFocus,
    disabled: disabled,
    "aria-invalid": String(isInvalid),
    paddingLeft: Math.round(height / 3.2),
    paddingRight: iconMargin * 2 + iconSize
  }, boxProps, {
    height: "100%"
  }), children), /*#__PURE__*/_react["default"].createElement(_icons.CaretDownIcon, {
    color: "default",
    size: iconSize,
    position: "absolute",
    top: "50%",
    marginTop: -iconSize / 2,
    right: iconMargin,
    pointerEvents: "none"
  }));
}));
Select.propTypes = _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, _uiBox.dimensions.propTypes), _uiBox.spacing.propTypes), _uiBox.position.propTypes), _uiBox.layout.propTypes), {}, {
  /**
   * The id attribute for the select.
   */
  id: _propTypes["default"].string,

  /**
   * The name attribute for the select.
   */
  name: _propTypes["default"].string,

  /**
   * The options that are passed to the select.
   */
  children: _propTypes["default"].node,

  /**
   * The initial value of an uncontrolled select
   */
  defaultValue: _propTypes["default"].any,

  /**
   * Function called when value changes.
   */
  onChange: _propTypes["default"].func,

  /**
   * The value of the select.
   */
  value: _propTypes["default"].any,

  /**
   * When true, the select is required.
   */
  required: _propTypes["default"].bool,

  /**
   * When true, the select should auto focus.
   */
  autoFocus: _propTypes["default"].bool,

  /**
   * When true, the select is invalid.
   */
  isInvalid: _propTypes["default"].bool,

  /**
   * The appearance of the select. The default theme only supports default.
   */
  appearance: _propTypes["default"].string
});
var _default = Select;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zZWxlY3Qvc3JjL1NlbGVjdC5qcyJdLCJuYW1lcyI6WyJpbnRlcm5hbFN0eWxlcyIsInRleHRUcmFuc2Zvcm0iLCJXZWJraXRBcHBlYXJhbmNlIiwiTW96QXBwZWFyYW5jZSIsImJvcmRlciIsImZsZXgiLCJiYWNrZ3JvdW5kIiwid2lkdGgiLCJXZWJraXRGb250U21vb3RoaW5nIiwidGV4dERlY29yYXRpb24iLCJvdXRsaW5lIiwiY3Vyc29yIiwiY29sb3IiLCJ0ZXh0U2hhZG93IiwicHNldWRvU2VsZWN0b3JzIiwiX2Rpc2FibGVkIiwiX2ludmFsaWQiLCJfaG92ZXIiLCJfZm9jdXMiLCJfYWN0aXZlIiwiZ2V0SWNvblNpemVGb3JTZWxlY3QiLCJoZWlnaHQiLCJTZWxlY3QiLCJwcm9wcyIsInJlZiIsImFwcGVhcmFuY2UiLCJhdXRvRm9jdXMiLCJjaGlsZHJlbiIsImRlZmF1bHRWYWx1ZSIsImRpc2FibGVkIiwiaGVpZ2h0UHJvcCIsImlkIiwiaXNJbnZhbGlkIiwibmFtZSIsIm9uQ2hhbmdlIiwicmVxdWlyZWQiLCJ2YWx1ZSIsInJlc3RQcm9wcyIsInNpemUiLCJ0aGVtZWRDbGFzc05hbWUiLCJjbGFzc05hbWUiLCJib3hQcm9wcyIsInRleHRQcm9wcyIsImljb25TaXplIiwiaWNvbk1hcmdpbiIsIlN0cmluZyIsIk1hdGgiLCJyb3VuZCIsInByb3BUeXBlcyIsImRpbWVuc2lvbnMiLCJzcGFjaW5nIiwicG9zaXRpb24iLCJsYXlvdXQiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJub2RlIiwiYW55IiwiZnVuYyIsImJvb2wiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSxjQUFjLEdBQUc7QUFDckJDLEVBQUFBLGFBQWEsRUFBRSxTQURNO0FBRXJCQyxFQUFBQSxnQkFBZ0IsRUFBRSxNQUZHO0FBR3JCQyxFQUFBQSxh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VDtBQU9FLElBQUEsYUFBYSxFQUFDO0FBUGhCLElBN0JGLENBREY7QUF5Q0QsQ0F4RUQsQ0FEYSxDQUFmO0FBNEVBdEIsTUFBTSxDQUFDMEIsU0FBUCw2RUFJS0Msa0JBQVdELFNBSmhCLEdBU0tFLGVBQVFGLFNBVGIsR0FjS0csZ0JBQVNILFNBZGQsR0FtQktJLGNBQU9KLFNBbkJaO0FBcUJFO0FBQ0Y7QUFDQTtBQUNFakIsRUFBQUEsRUFBRSxFQUFFc0Isc0JBQVVDLE1BeEJoQjs7QUEwQkU7QUFDRjtBQUNBO0FBQ0VyQixFQUFBQSxJQUFJLEVBQUVvQixzQkFBVUMsTUE3QmxCOztBQStCRTtBQUNGO0FBQ0E7QUFDRTNCLEVBQUFBLFFBQVEsRUFBRTBCLHNCQUFVRSxJQWxDdEI7O0FBb0NFO0FBQ0Y7QUFDQTtBQUNFM0IsRUFBQUEsWUFBWSxFQUFFeUIsc0JBQVVHLEdBdkMxQjs7QUF5Q0U7QUFDRjtBQUNBO0FBQ0V0QixFQUFBQSxRQUFRLEVBQUVtQixzQkFBVUksSUE1Q3RCOztBQThDRTtBQUNGO0FBQ0E7QUFDRXJCLEVBQUFBLEtBQUssRUFBRWlCLHNCQUFVRyxHQWpEbkI7O0FBbURFO0FBQ0Y7QUFDQTtBQUNFckIsRUFBQUEsUUFBUSxFQUFFa0Isc0JBQVVLLElBdER0Qjs7QUF3REU7QUFDRjtBQUNBO0FBQ0VoQyxFQUFBQSxTQUFTLEVBQUUyQixzQkFBVUssSUEzRHZCOztBQTZERTtBQUNGO0FBQ0E7QUFDRTFCLEVBQUFBLFNBQVMsRUFBRXFCLHNCQUFVSyxJQWhFdkI7O0FBa0VFO0FBQ0Y7QUFDQTtBQUNFakMsRUFBQUEsVUFBVSxFQUFFNEIsc0JBQVVDO0FBckV4QjtlQXdFZWhDLE0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgbWVtbywgZm9yd2FyZFJlZiB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJ1xuaW1wb3J0IEJveCwgeyBkaW1lbnNpb25zLCBzcGFjaW5nLCBwb3NpdGlvbiwgbGF5b3V0IH0gZnJvbSAndWktYm94J1xuaW1wb3J0IHsgdXNlU3R5bGVDb25maWcgfSBmcm9tICcuLi8uLi9ob29rcydcbmltcG9ydCB7IENhcmV0RG93bkljb24gfSBmcm9tICcuLi8uLi9pY29ucydcbmltcG9ydCB7IGdldFRleHRQcm9wc0ZvckNvbnRyb2xIZWlnaHQgfSBmcm9tICcuLi8uLi9saWIvZGVwcmVjYXRlZC10aGVtZS1oZWxwZXJzJ1xuXG5jb25zdCBpbnRlcm5hbFN0eWxlcyA9IHtcbiAgdGV4dFRyYW5zZm9ybTogJ2RlZmF1bHQnLFxuICBXZWJraXRBcHBlYXJhbmNlOiAnbm9uZScsXG4gIE1vekFwcGVhcmFuY2U6ICdub25lJyxcbiAgYm9yZGVyOiAnbm9uZScsXG4gIGZsZXg6IDEsXG4gIGJhY2tncm91bmQ6ICdub25lJyxcbiAgd2lkdGg6ICcxMDAlJyxcbiAgV2Via2l0Rm9udFNtb290aGluZzogJ2FudGlhbGlhc2VkJyxcbiAgdGV4dERlY29yYXRpb246ICdub25lJyxcbiAgb3V0bGluZTogJ25vbmUnLFxuICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgJzotbW96LWZvY3VzcmluZyc6IHtcbiAgICBjb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICB0ZXh0U2hhZG93OiAnMCAwIDAgIzAwMCdcbiAgfVxufVxuXG5jb25zdCBwc2V1ZG9TZWxlY3RvcnMgPSB7XG4gIF9kaXNhYmxlZDogJ1tkaXNhYmxlZF0nLFxuICBfaW52YWxpZDogJyZbYXJpYS1pbnZhbGlkPVwidHJ1ZVwiXScsXG4gIF9ob3ZlcjogJyY6bm90KFtkaXNhYmxlZF0pOmhvdmVyJyxcbiAgX2ZvY3VzOiAnJjpub3QoW2Rpc2FibGVkXSk6Zm9jdXMnLFxuICBfYWN0aXZlOiAnJjpub3QoW2Rpc2FibGVkXSk6YWN0aXZlJ1xufVxuXG5jb25zdCBnZXRJY29uU2l6ZUZvclNlbGVjdCA9IGhlaWdodCA9PiB7XG4gIGlmIChoZWlnaHQgPD0gMjgpIHJldHVybiAxMlxuICBpZiAoaGVpZ2h0IDw9IDMyKSByZXR1cm4gMTQgLy8gU2xpZ2h0bHkgYmlnZ2VyIHRoYW4gZ2V0SWNvblNpemVGb3JCdXR0b25cbiAgaWYgKGhlaWdodCA8PSA0MCkgcmV0dXJuIDE2XG4gIGlmIChoZWlnaHQgPD0gNDgpIHJldHVybiAxOFxuICByZXR1cm4gMjBcbn1cblxuY29uc3QgU2VsZWN0ID0gbWVtbyhcbiAgZm9yd2FyZFJlZihmdW5jdGlvbiBTZWxlY3QocHJvcHMsIHJlZikge1xuICAgIGNvbnN0IHtcbiAgICAgIGFwcGVhcmFuY2UgPSAnZGVmYXVsdCcsXG4gICAgICBhdXRvRm9jdXMsXG4gICAgICBjaGlsZHJlbixcbiAgICAgIGRlZmF1bHRWYWx1ZSxcbiAgICAgIGRpc2FibGVkLFxuICAgICAgaGVpZ2h0OiBoZWlnaHRQcm9wLFxuICAgICAgaWQsXG4gICAgICBpc0ludmFsaWQgPSBmYWxzZSxcbiAgICAgIG5hbWUsXG4gICAgICBvbkNoYW5nZSxcbiAgICAgIHJlcXVpcmVkLFxuICAgICAgdmFsdWUsXG4gICAgICAuLi5yZXN0UHJvcHNcbiAgICB9ID0gcHJvcHNcblxuICAgIGNvbnN0IHsgY2xhc3NOYW1lOiB0aGVtZWRDbGFzc05hbWUsIC4uLmJveFByb3BzIH0gPSB1c2VTdHlsZUNvbmZpZyhcbiAgICAgICdTZWxlY3QnLFxuICAgICAgeyBhcHBlYXJhbmNlLCBzaXplOiByZXN0UHJvcHMuc2l6ZSB8fCAnbWVkaXVtJyB9LFxuICAgICAgcHNldWRvU2VsZWN0b3JzLFxuICAgICAgaW50ZXJuYWxTdHlsZXNcbiAgICApXG5cbiAgICBjb25zdCBoZWlnaHQgPSBoZWlnaHRQcm9wIHx8IGJveFByb3BzLmhlaWdodFxuXG4gICAgY29uc3QgdGV4dFByb3BzID0gIXJlc3RQcm9wcy5zaXplICYmIHJlc3RQcm9wcy5oZWlnaHQgPyBnZXRUZXh0UHJvcHNGb3JDb250cm9sSGVpZ2h0KHJlc3RQcm9wcy5oZWlnaHQpIDoge31cblxuICAgIGNvbnN0IGljb25TaXplID0gZ2V0SWNvblNpemVGb3JTZWxlY3QoaGVpZ2h0KVxuICAgIGNvbnN0IGljb25NYXJnaW4gPSBoZWlnaHQgPj0gMzYgPyAxMiA6IDhcblxuICAgIHJldHVybiAoXG4gICAgICA8Qm94XG4gICAgICAgIHJlZj17cmVmfVxuICAgICAgICBkaXNwbGF5PVwiaW5saW5lLWZsZXhcIlxuICAgICAgICBmbGV4PXsxfVxuICAgICAgICBwb3NpdGlvbj1cInJlbGF0aXZlXCJcbiAgICAgICAgd2lkdGg9XCJhdXRvXCJcbiAgICAgICAgaGVpZ2h0PXtoZWlnaHR9XG4gICAgICAgIHsuLi5yZXN0UHJvcHN9XG4gICAgICAgIHsuLi50ZXh0UHJvcHN9XG4gICAgICA+XG4gICAgICAgIDxCb3hcbiAgICAgICAgICBpcz1cInNlbGVjdFwiXG4gICAgICAgICAgY2xhc3NOYW1lPXt0aGVtZWRDbGFzc05hbWV9XG4gICAgICAgICAgaWQ9e2lkfVxuICAgICAgICAgIG5hbWU9e25hbWV9XG4gICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAgIGRlZmF1bHRWYWx1ZT17ZGVmYXVsdFZhbHVlfVxuICAgICAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgICAgICByZXF1aXJlZD17cmVxdWlyZWR9XG4gICAgICAgICAgYXV0b0ZvY3VzPXthdXRvRm9jdXN9XG4gICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgIGFyaWEtaW52YWxpZD17U3RyaW5nKGlzSW52YWxpZCl9XG4gICAgICAgICAgcGFkZGluZ0xlZnQ9e01hdGgucm91bmQoaGVpZ2h0IC8gMy4yKX1cbiAgICAgICAgICBwYWRkaW5nUmlnaHQ9e2ljb25NYXJnaW4gKiAyICsgaWNvblNpemV9XG4gICAgICAgICAgey4uLmJveFByb3BzfVxuICAgICAgICAgIGhlaWdodD1cIjEwMCVcIlxuICAgICAgICA+XG4gICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICA8L0JveD5cbiAgICAgICAgPENhcmV0RG93bkljb25cbiAgICAgICAgICBjb2xvcj1cImRlZmF1bHRcIlxuICAgICAgICAgIHNpemU9e2ljb25TaXplfVxuICAgICAgICAgIHBvc2l0aW9uPVwiYWJzb2x1dGVcIlxuICAgICAgICAgIHRvcD1cIjUwJVwiXG4gICAgICAgICAgbWFyZ2luVG9wPXstaWNvblNpemUgLyAyfVxuICAgICAgICAgIHJpZ2h0PXtpY29uTWFyZ2lufVxuICAgICAgICAgIHBvaW50ZXJFdmVudHM9XCJub25lXCJcbiAgICAgICAgLz5cbiAgICAgIDwvQm94PlxuICAgIClcbiAgfSlcbilcblxuU2VsZWN0LnByb3BUeXBlcyA9IHtcbiAgLyoqXG4gICAqIENvbXBvc2VzIHRoZSBkaW1lbnNpb25zIHNwZWMgZnJvbSB0aGUgQm94IHByaW1pdGl2ZS5cbiAgICovXG4gIC4uLmRpbWVuc2lvbnMucHJvcFR5cGVzLFxuXG4gIC8qKlxuICAgKiBDb21wb3NlcyB0aGUgc3BhY2luZyBzcGVjIGZyb20gdGhlIEJveCBwcmltaXRpdmUuXG4gICAqL1xuICAuLi5zcGFjaW5nLnByb3BUeXBlcyxcblxuICAvKipcbiAgICogQ29tcG9zZXMgdGhlIHBvc2l0aW9uIHNwZWMgZnJvbSB0aGUgQm94IHByaW1pdGl2ZS5cbiAgICovXG4gIC4uLnBvc2l0aW9uLnByb3BUeXBlcyxcblxuICAvKipcbiAgICogQ29tcG9zZXMgdGhlIGxheW91dCBzcGVjIGZyb20gdGhlIEJveCBwcmltaXRpdmUuXG4gICAqL1xuICAuLi5sYXlvdXQucHJvcFR5cGVzLFxuXG4gIC8qKlxuICAgKiBUaGUgaWQgYXR0cmlidXRlIGZvciB0aGUgc2VsZWN0LlxuICAgKi9cbiAgaWQ6IFByb3BUeXBlcy5zdHJpbmcsXG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIGF0dHJpYnV0ZSBmb3IgdGhlIHNlbGVjdC5cbiAgICovXG4gIG5hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG5cbiAgLyoqXG4gICAqIFRoZSBvcHRpb25zIHRoYXQgYXJlIHBhc3NlZCB0byB0aGUgc2VsZWN0LlxuICAgKi9cbiAgY2hpbGRyZW46IFByb3BUeXBlcy5ub2RlLFxuXG4gIC8qKlxuICAgKiBUaGUgaW5pdGlhbCB2YWx1ZSBvZiBhbiB1bmNvbnRyb2xsZWQgc2VsZWN0XG4gICAqL1xuICBkZWZhdWx0VmFsdWU6IFByb3BUeXBlcy5hbnksXG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIHZhbHVlIGNoYW5nZXMuXG4gICAqL1xuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBvZiB0aGUgc2VsZWN0LlxuICAgKi9cbiAgdmFsdWU6IFByb3BUeXBlcy5hbnksXG5cbiAgLyoqXG4gICAqIFdoZW4gdHJ1ZSwgdGhlIHNlbGVjdCBpcyByZXF1aXJlZC5cbiAgICovXG4gIHJlcXVpcmVkOiBQcm9wVHlwZXMuYm9vbCxcblxuICAvKipcbiAgICogV2hlbiB0cnVlLCB0aGUgc2VsZWN0IHNob3VsZCBhdXRvIGZvY3VzLlxuICAgKi9cbiAgYXV0b0ZvY3VzOiBQcm9wVHlwZXMuYm9vbCxcblxuICAvKipcbiAgICogV2hlbiB0cnVlLCB0aGUgc2VsZWN0IGlzIGludmFsaWQuXG4gICAqL1xuICBpc0ludmFsaWQ6IFByb3BUeXBlcy5ib29sLFxuXG4gIC8qKlxuICAgKiBUaGUgYXBwZWFyYW5jZSBvZiB0aGUgc2VsZWN0LiBUaGUgZGVmYXVsdCB0aGVtZSBvbmx5IHN1cHBvcnRzIGRlZmF1bHQuXG4gICAqL1xuICBhcHBlYXJhbmNlOiBQcm9wVHlwZXMuc3RyaW5nXG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlbGVjdFxuIl19